{% extends 'base.html' %}
{% block title %}CK Intelligence{% endblock %}

{% block head_extra %}
<link rel="icon" type="image/png" href="../static/images/logo_ai3.png">
<link rel="shortcut icon" type="image/png" href="../static/images/logo_ai3.png">
<style>
  /* Modern Grok AI inspired theme */
  [data-bs-theme="dark"] {
    --bg-primary: #000000;
    --bg-secondary: #0f0f0f;
    --bg-tertiary: #1a1a1a;
    --bg-gradient: linear-gradient(135deg, #000000 0%, #0f0f0f 50%, #1a1a1a 100%);
    --text-primary: #ffffff;
    --text-secondary: #a0a0a0;
    --text-muted: #808080;
    --accent-primary: #00d4aa;
    --accent-secondary: #00b894;
    --accent-glow: rgba(0, 212, 170, 0.3);
    --border-color: #2a2a2a;
    --border-subtle: #1a1a1a;
    --message-user: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
    --message-bot: #1a1a1a;
    --shadow-primary: 0 4px 20px rgba(0, 0, 0, 0.5);
    --shadow-accent: 0 0 20px rgba(0, 212, 170, 0.1);
  }

  body {
    background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
    min-height: 100vh;
    overflow-x: hidden; /* Prevent horizontal scroll */
  }

  .chatbot-container {
    width: 100%;
    max-width: 1000px;
    margin: 0 auto;
    background: rgba(26, 26, 26, 0.9);
    border-radius: 20px;
    border: none;
    overflow: visible;
    position: relative;
    box-sizing: border-box;
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0; /* Allow flex child to shrink */
    /* Ensure mouse events reach the chat area */
    pointer-events: auto;
  }

  .chat-header {
    background: var(--bg-secondary);
    padding: 2rem 1.5rem;
    text-align: center;
    border-bottom: 1px solid var(--border-subtle);
    position: relative;
    overflow: hidden;
  }

  .chat-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(0, 212, 170, 0.1), transparent);
    animation: shimmer 3s infinite;
  }

  @keyframes shimmer {
    0% { left: -100%; }
    50% { left: 100%; }
    100% { left: -100%; }
  }

  .theme-notice {
    background: rgba(59, 130, 246, 0.1);
    border: 1px solid rgba(59, 130, 246, 0.3);
    border-radius: 8px;
    padding: 0.5rem 1rem;
    margin-bottom: 1rem;
    font-size: 0.875rem;
    color: var(--text-secondary);
    text-align: center;
  }

  .theme-notice i {
    color: #3b82f6;
    margin-right: 0.5rem;
  }

  .chat-header h1 {
    color: var(--text-primary);
    margin: 0;
    font-size: 2rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    letter-spacing: -0.5px;
    position: relative;
    z-index: 1;
  }

  .chat-header h1::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
    border-radius: 1px;
  }

  .chat-messages {
    min-height: 75vh;
    max-height: calc(100vh - 200px);
    height: calc(100vh - 200px);
    overflow-y: auto;
    padding: 2rem;
    padding-bottom: 2rem;
    background: rgba(15, 15, 15, 0.4);
    border-radius: 24px;
    border: 1px solid var(--border-subtle);
    backdrop-filter: blur(10px);
    scroll-behavior: smooth;
    width: 100%;
    max-width: 1000px;
    margin: 0 auto;
    box-sizing: border-box;
    /* Hide scrollbar completely */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
    /* Enable mouse wheel scrolling on the entire container */
    pointer-events: auto;
  }

  /* Hide scrollbar for Chrome, Safari and Opera */
  .chat-messages::-webkit-scrollbar {
    display: none;
  }



  /* Special handling for welcome message - ensure it fits without scrolling */
  .chat-messages:has(.welcome-message) {
    height: auto;
    max-height: none;
    overflow-y: visible;
  }

  .message {
    margin-bottom: 1.5rem;
    animation: fadeIn 0.3s ease-in;
  }

  .message-user {
    display: flex;
    justify-content: flex-end;
  }

  .message-bot {
    display: flex;
    justify-content: flex-start;
  }

  .message-bubble {
    max-width: 75%;
    padding: 1.25rem 1.5rem;
    border-radius: 20px;
    font-size: 0.95rem;
    line-height: 1.5;
    position: relative;
    word-wrap: break-word;
    border: 1px solid transparent;
    transition: all 0.3s ease;
  }

  .message-bubble:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }



  /* Bottom copy button styles */
  .copy-button-bottom {
    position: absolute;
    bottom: 8px;
    right: 8px;
    background: rgba(0, 0, 0, 0.1);
    color: white;
    border: none;
    border-radius: 6px;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 0;
    transition: all 0.2s ease;
    font-size: 14px;
    backdrop-filter: blur(10px);
  }

  .copy-button-bottom:hover {
    background: rgba(59, 130, 246, 1);
    transform: scale(1.1);
  }

  .message-bubble:hover .copy-button-bottom {
    opacity: 1;
  }

  /* Only show copy button for bot messages */
  .message-user .copy-button-bottom {
    display: none;
  }

  .message-user .message-bubble {
    background: var(--message-user);
    color: white;
    border-bottom-right-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 212, 170, 0.3);
    border: 1px solid rgba(0, 212, 170, 0.2);
  }

  /* .message-user .message-bubble::before {
    content: '';
    position: absolute;
    bottom: -2px;
    right: 20px;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid rgba(0, 212, 170, 0.8);
  } */

  .message-bot .message-bubble {
    background: var(--message-bot);
    color: var(--text-primary);
    border: 1px solid var(--border-subtle);
    border-bottom-left-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }

  .message-bot .message-bubble::before {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 20px;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid var(--border-subtle);
  }

  .message-bot .typing-bubble {
    background: var(--message-bot);
    border: 1px solid var(--border-subtle);
    border-bottom-left-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }

  .message-bot .typing-bubble::before {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 20px;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid var(--border-subtle);
  }

  .message-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 1rem;
    font-size: 1.2rem;
    flex-shrink: 0;
  }

  .message-user .message-avatar {
    background: linear-gradient(135deg, var(--message-user) 0%, var(--accent-secondary) 100%);
    color: white;
  }

  .message-bot .message-avatar {
    background: var(--bg-tertiary);
    color: var(--accent-primary);
    border: 2px solid var(--border-color);
  }

  .typing-indicator {
    display: flex;
    align-items: center;
    padding: 1rem 1.5rem;
    margin: 1rem 0;
    width: 100%;
    color: var(--text-secondary);
    font-style: italic;
    /* Remove background, border, and effects */
    animation: fadeIn 0.3s ease-in;
  }

  .typing-dots {
    display: flex;
    gap: 4px;
    margin-left: 0.5rem;
  }

  .typing-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--accent-primary);
    animation: typing 1.4s infinite;
  }

  .typing-dot:nth-child(2) { animation-delay: 0.2s; }
  .typing-dot:nth-child(3) { animation-delay: 0.4s; }

  @keyframes typing {
    0%, 60%, 100% { transform: scale(1); opacity: 0.5; }
    30% { transform: scale(1.2); opacity: 1; }
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .chat-input-container {
    padding: 1.5rem;
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    max-width: 1000px; /* Match chat-messages width */
    background: rgba(26, 26, 26, 0.98);
    backdrop-filter: blur(20px);
    border: 1px solid var(--border-color);
    border-radius: 28px;
    z-index: 1000;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  }



  .chat-input-form {
    display: flex;
    gap: 1rem;
    align-items: flex-end;
    max-width: 1000px; /* Match chat-messages width */
    margin: 0 auto;
  }

  .chat-input {
    flex: 1;
    background: var(--bg-tertiary);
    border: 2px solid var(--border-color);
    border-radius: 28px;
    padding: 1rem 1.5rem;
    color: var(--text-primary);
    font-size: 0.95rem;
    resize: none;
    min-height: 56px;
    max-height: 120px;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    /* Hide scrollbar for user input */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }

  /* Hide scrollbar for Chrome, Safari and Opera in chat input */
  .chat-input::-webkit-scrollbar {
    display: none;
  }

  .chat-input:focus {
    /* outline: aliceblue; */
    border-color: rgba(250, 235, 215, 0.082);
    box-shadow: none;
    transform: none;
  }

  .chat-input::placeholder {
    color: var(--text-muted);
    font-style: italic;
  }

  .send-button {
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    border: none;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    flex-shrink: 0;
    box-shadow: 0 2px 8px rgba(0, 212, 170, 0.3);
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
  }

  .send-button::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
  }

  .send-button:hover::before {
    width: 300px;
    height: 300px;
  }

  .send-button:hover {
    transform: scale(1.05) translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 212, 170, 0.4);
  }

  .send-button:active {
    transform: scale(0.98) translateY(0);
  }

  .send-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .send-button i {
    font-size: 1.2rem;
    position: relative;
    z-index: 1;
  }

  .suggestions {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 0.75rem;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  .suggestion-chip {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 24px;
    padding: 0.75rem 1.25rem;
    font-size: 0.9rem;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    font-weight: 500;
    position: relative;
    overflow: hidden;
  }

  .suggestion-chip::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: rgba(0, 212, 170, 0.1);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
  }

  .suggestion-chip:hover::before {
    width: 300px;
    height: 300px;
  }

  .suggestion-chip:hover {
    background: var(--accent-primary);
    color: white;
    border-color: var(--accent-primary);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
  }

  .suggestion-chip:active {
    transform: translateY(0);
  }

  .welcome-message {
    text-align: center;
    padding: 3rem 2rem;
    color: var(--text-secondary);
    background: rgba(26, 26, 26, 0.6);
    border-radius: 24px;
    margin: 0;
    border: 1px solid var(--border-subtle);
    backdrop-filter: blur(15px);
    position: relative;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  }

  .welcome-message::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(0, 212, 170, 0.05), transparent);
    animation: welcomeShimmer 4s infinite;
  }

  .welcome-message h2 {
    color: var(--text-primary);
    margin-bottom: 1.5rem;
    font-size: 1.8rem;
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    position: relative;
    z-index: 1;
  }

  @keyframes welcomeShimmer {
    0% { left: -100%; }
    50% { left: 100%; }
    100% { left: -100%; }
  }

  .response-suggestions {
    margin: 1rem 0;
    animation: fadeInSuggestions 0.5s ease-in;
  }

  .response-suggestions .suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
    justify-content: flex-end; /* Align to the right like bot messages */
  }

  .response-suggestions .suggestion-chip {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 20px;
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    font-weight: 500;
  }

  .response-suggestions .suggestion-chip:hover {
    background: var(--accent-primary);
    color: white;
    border-color: var(--accent-primary);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
  }

  .batch-details-container {
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 1rem;
    margin-bottom: 1rem;
    border: 1px solid var(--border-color);
  }

  .batch-content {
    line-height: 1.6;
    color: var(--text-primary);
  }

  .clickable-batch {
    transition: all 0.2s ease;
  }

  .clickable-batch:hover {
    opacity: 0.8;
    transform: scale(1.05);
  }

  @keyframes fadeInSuggestions {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }



  /* Typing text styling */
  .typing-text {
    position: relative;
  }

  .typing-text::after {
    content: '|';
    animation: blink-caret 1s step-end infinite;
    color: var(--accent-primary);
  }

  @keyframes blink-caret {
    from, to { opacity: 1; }
    50% { opacity: 0; }
  }

  /* Typing cursor for messages */
  .message-bubble .cursor {
    display: inline-block;
    width: 2px;
    height: 1.2em;
    background-color: var(--accent-primary);
    animation: blink 1s step-end infinite;
    margin-left: 2px;
  }

  @keyframes blink {
    from, to { opacity: 1; }
    50% { opacity: 0; }
  }

  /* Database Data Panel Styles */
  .database-data-panel {
    background: var(--bg-tertiary);
    border-radius: 12px;
    border: 1px solid var(--border-color);
    overflow: hidden;
  }

  .data-header {
    background: var(--bg-secondary);
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .data-header h3 {
    color: var(--text-primary);
    margin: 0;
    font-size: 1.1rem;
    font-weight: 600;
  }

  .data-content {
    padding: 1.5rem;
    max-height: 400px;
    overflow-y: auto;
  }

  .data-section {
    margin-bottom: 1.5rem;
  }

  .data-section h4 {
    color: var(--accent-primary);
    margin-bottom: 0.5rem;
    font-size: 1rem;
    font-weight: 600;
  }

  .data-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .data-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1rem;
  }

  .data-card h5 {
    color: var(--text-primary);
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
    font-weight: 600;
  }

  .data-value {
    color: var(--accent-primary);
    font-size: 1.2rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
  }

  .data-label {
    color: var(--text-secondary);
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .inventory-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 0.5rem;
  }

  .inventory-table th,
  .inventory-table td {
    padding: 0.5rem 0.75rem;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
  }

  .inventory-table th {
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-weight: 600;
    font-size: 0.85rem;
  }

  .inventory-table td {
    color: var(--text-primary);
    font-size: 0.8rem;
  }

  .status-full {
    color: #10b981;
    font-weight: 600;
  }

  .status-not-full {
    color: #f59e0b;
    font-weight: 600;
  }

  .status-not-have {
    color: #ef4444;
    font-weight: 600;
  }

  .loading-spinner {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 2rem;
    color: var(--text-secondary);
  }

  .loading-spinner i {
    animation: spin 1s linear infinite;
    margin-right: 0.5rem;
  }

  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .error-message {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
    border-radius: 8px;
    padding: 1rem;
    color: #ef4444;
    text-align: center;
  }

  .clickable-card {
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .clickable-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
    border-color: var(--accent-primary);
  }

  /* Contact Information Styles */
  .contact-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  }

  .contact-item {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 1rem;
    text-align: center;
  }

  .contact-item h5 {
    color: var(--accent-primary);
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
    font-weight: 600;
  }

  .contact-item p {
    color: var(--text-primary);
    font-size: 0.85rem;
    line-height: 1.4;
  }

  .contact-item a {
    color: var(--accent-primary);
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .contact-item a:hover {
    color: var(--accent-secondary);
    text-decoration: underline;
  }

  /* Hide navbar and footer for full-screen experience */
  nav.navbar,
  footer.footer {
    display: none !important;
  }

  /* Full-screen layout like Grok.com */
  body {
    margin: 0;
    padding: 0;
    overflow-x: hidden;
    background: var(--bg-primary);
  }

  .container {
    max-width: none;
    margin: 0;
    padding: 0;
  }



  /* Update input container for Grok style */
  /* .chat-input-container {
    background: transparent;
    padding: 1rem 0;
    border-top: none;
    position: static;
  } */

  .chat-input-form {
    max-width: 1000px; /* Consistent with chat-messages width */
    margin: 0 auto;
  }

  /* Remove old chat header styles since we have ckintelligence-header now */
  .chat-header {
    display: none;
  }

  /* Grok-style centered layout */
  .ckintelligence-container {
    min-height: 100vh;
    height: 100vh; /* Fixed height to prevent body scrolling */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    background: linear-gradient(135deg, #000000 0%, #0f0f0f 50%, #1a1a1a 100%);
    position: relative;
    padding: 1rem 1rem 6rem 1rem;
    box-sizing: border-box;
    width: 100%;
    overflow: hidden; /* Prevent all scrolling on container */
    /* Allow pointer events to reach child elements */
    pointer-events: auto;
  }

  /* Grok Header */
  .ckintelligence-header {
    text-align: center;
    margin-bottom: 2rem;
    z-index: 10;
  }

  .ckintelligence-brand {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
  }

  .ckintelligence-logo {
    width: 80px;
    height: 70px;
    filter: drop-shadow(0 4px 8px rgba(0, 212, 170, 0.3));
    transition: transform 0.3s ease;
  }

  .ckintelligence-logo:hover {
    transform: scale(1.05);
  }

  .ckintelligence-title h1 {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-primary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .ckintelligence-subtitle {
    color: var(--text-secondary);
    font-size: 1rem;
    margin: 0.5rem 0 0 0;
    opacity: 0.8;
  }

  /* Hide ckintelligence-title when user interacts */
  .ckintelligence-container.interacted .ckintelligence-title {
    display: none;
  }

  /* Hide ckintelligence-logo when user interacts */
  .ckintelligence-container.interacted .ckintelligence-logo {
    display: none;
  }

  /* Welcome Section */
  .welcome-section {
    max-width: 1000px;
    width: 100%;
    margin-bottom: 2rem;
  }

  .company-info {
    margin-top: 1.5rem;
    padding: 1.5rem;
    background: var(--bg-secondary);
    border-radius: 16px;
    border: 1px solid var(--border-subtle);
    text-align: center;
  }

  .company-info p {
    color: var(--text-secondary);
    margin: 0;
    font-size: 0.9rem;
    line-height: 1.6;
  }

  .company-info a {
    color: var(--accent-primary);
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .company-info a:hover {
    color: var(--accent-secondary);
    text-decoration: underline;
  }

  .ckintelligence-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background:
      radial-gradient(circle at 20% 80%, rgba(0, 212, 170, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(0, 212, 170, 0.08) 0%, transparent 50%),
      radial-gradient(circle at 40% 40%, rgba(0, 212, 170, 0.05) 0%, transparent 50%);
    pointer-events: none;
    z-index: -1;
  }

  /* Tablet responsiveness */
  @media (max-width: 1024px) and (min-width: 769px) {
    .chat-messages {
      min-height: 45vh;
      max-height: 65vh;
      height: calc(100vh - 280px);
      padding: 1.25rem;
      padding-bottom: 120px; /* Space for tablet floating input */
    }

    .chat-messages:has(.welcome-message) {
      height: auto;
      max-height: none;
      overflow-y: visible;
    }
  }

  /* Mobile responsiveness for Grok-style layout */
  @media (max-width: 768px) {
    .ckintelligence-container {
      padding: 1rem 0.5rem 6rem 0.5rem;
      min-height: 100vh;
      min-height: 100dvh; /* Dynamic viewport height for mobile */
      height: 100vh;
      height: 100dvh;
      overflow: hidden; /* Prevent container scrolling */
    }

    .ckintelligence-header {
      margin-bottom: 1rem;
      width: 100%;
    }

    .ckintelligence-brand {
      margin-bottom: 1.5rem;
    }

    .ckintelligence-title h1 {
      font-size: 2rem;
    }

    .ckintelligence-subtitle {
      font-size: 0.9rem;
    }

    .ckintelligence-logo {
      width: 60px;
      height: 50px;
    }

    .chatbot-container {
      width: 100%;
      max-width: none;
      margin: 0;
      padding: 0 0.5rem;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .chat-messages {
      min-height: 70vh;
      max-height: calc(100vh - 180px);
      max-height: calc(100dvh - 180px);
      height: calc(100vh - 180px);
      height: calc(100dvh - 180px);
      padding: 1rem;
      padding-bottom: 1rem;
      border-radius: 20px;
      background: rgba(15, 15, 15, 0.8);
      border: 1px solid var(--border-color);
      width: 100%;
      box-sizing: border-box;
      flex: 1;
      overflow-y: auto;
      pointer-events: auto;
    }

    .chat-messages:has(.welcome-message) {
      height: auto;
      max-height: none;
      overflow-y: visible;
    }

    .message-bubble {
      max-width: 95%;
      padding: 1rem 1.25rem;
      font-size: 0.9rem;
      border-radius: 16px;
    }

    .typing-indicator {
      margin: 0.5rem 0;
      padding: 0.875rem 1.25rem;
      width: 100%;
      /* Remove background, border, and effects for mobile */
    }

    .chat-input-container {
      padding: 1rem;
      bottom: 10px;
      left: 10px;
      right: 10px;
      transform: none;
      width: auto;
      max-width: none;
      background: rgba(26, 26, 26, 0.98);
      border-radius: 20px;
      border: 1px solid var(--border-color);
      box-sizing: border-box;
    }

    .chat-input-form {
      gap: 0.75rem;
    }

    .chat-input {
      padding: 0.875rem 1.25rem;
      min-height: 48px;
      font-size: 0.95rem;
      border-radius: 24px;
      /* Hide scrollbar for mobile */
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .chat-input::-webkit-scrollbar {
      display: none;
    }

    .send-button {
      width: 48px;
      height: 48px;
    }

    .send-button i {
      font-size: 1.1rem;
    }

    .welcome-message {
      padding: 2rem 1.5rem;
      margin: 0;
      border-radius: 16px;
    }

    .welcome-message h2 {
      font-size: 1.75rem;
      margin-bottom: 1rem;
    }

    .suggestions {
      gap: 0.75rem;
    }

    .suggestion-chip {
      padding: 0.75rem 1rem;
      font-size: 0.9rem;
      border-radius: 20px;
    }

    .message-avatar {
      width: 36px;
      height: 36px;
      margin: 0 0.75rem;
    }

    .data-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .data-content {
      max-height: 300px;
      padding: 1rem;
    }

    .contact-info-grid {
      grid-template-columns: 1fr;
      gap: 0.75rem;
    }
  }

  /* Extra small screens (phones in landscape) */
  @media (max-width: 480px) {
    .ckintelligence-container {
      padding: 0.75rem 0.25rem 5rem 0.25rem;
      min-height: 100vh;
      min-height: 100dvh;
      height: 100vh;
      height: 100dvh;
      overflow: hidden; /* Prevent container scrolling */
    }

    .ckintelligence-brand {
      margin-bottom: 1rem;
    }

    .ckintelligence-title h1 {
      font-size: 1.75rem;
    }

    .ckintelligence-subtitle {
      font-size: 0.8rem;
    }

    .ckintelligence-logo {
      width: 50px;
      height: 40px;
    }

    .chatbot-container {
      width: 100%;
      max-width: none;
      margin: 0;
      padding: 0 0.25rem;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .chat-messages {
      min-height: 65vh;
      max-height: calc(100vh - 160px);
      max-height: calc(100dvh - 160px);
      height: calc(100vh - 160px);
      height: calc(100dvh - 160px);
      padding: 0.75rem;
      padding-bottom: 0.75rem;
      border-radius: 16px;
      background: rgba(15, 15, 15, 0.8);
      border: 1px solid var(--border-color);
      
      width: 100%;
      box-sizing: border-box;
      flex: 1;
      overflow-y: auto;
      pointer-events: auto;
    }

    .chat-messages:has(.welcome-message) {
      height: auto;
      max-height: none;
      overflow-y: visible;
    }

    .message-bubble {
      max-width: 98%;
      padding: 0.875rem 1rem;
      font-size: 0.85rem;
      border-radius: 14px;
    }

    .typing-indicator {
      margin: 0.25rem 0;
      padding: 0.75rem 1rem;
      width: 100%;
      /* Remove background, border, and effects for small screens */
    }

    .chat-input-container {
      padding: 0.75rem;
      bottom: 8px;
      left: 8px;
      right: 8px;
      transform: none;
      width: auto;
      max-width: none;
      background: rgba(26, 26, 26, 0.98);
      border-radius: 16px;
      border: 1px solid var(--border-color);
      box-sizing: border-box;
    }

    .chat-input-form {
      gap: 0.5rem;
    }

    .chat-input {
      padding: 0.75rem 1rem;
      min-height: 44px;
      font-size: 0.9rem;
      border-radius: 20px;
      /* Hide scrollbar for small screens */
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .chat-input::-webkit-scrollbar {
      display: none;
    }

    .send-button {
      width: 44px;
      height: 44px;
    }

    .send-button i {
      font-size: 1rem;
    }

    .welcome-message {
      padding: 1.5rem 1rem;
      border-radius: 14px;
    }

    .welcome-message h2 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .suggestion-chip {
      padding: 0.625rem 0.875rem;
      font-size: 0.8rem;
      border-radius: 16px;
    }

    .message-avatar {
      width: 32px;
      height: 32px;
      margin: 0 0.5rem;
    }
  }

  /* Sidebar Styles */
  .sidebar {
    position: fixed;
    top: 0;
    left: -400px;
    width: 400px;
    height: 100vh;
    background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
    border-right: 1px solid var(--border-color);
    box-shadow: var(--shadow-primary);
    z-index: 1000;
    transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    overflow-y: auto;
    backdrop-filter: blur(10px);
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* Internet Explorer 10+ */
  }

  .sidebar::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }

  .sidebar.active {
    left: 0;
  }

  .sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-color);
    background: rgba(26, 26, 26, 0.95);
    backdrop-filter: blur(10px);
    position: sticky;
    top: 0;
    z-index: 10;
  }

  .sidebar-logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .sidebar-logo-img {
    width: 40px;
    height: 35px;
    filter: drop-shadow(0 2px 4px rgba(0, 212, 170, 0.3));
  }

  .sidebar-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
    background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-primary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .sidebar-close {
    background: none;
    border: none;
    color: var(--text-secondary);
    font-size: 1.25rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 8px;
    transition: all 0.2s ease;
  }

  .sidebar-close:hover {
    color: var(--accent-primary);
    background: rgba(0, 212, 170, 0.1);
  }

  .sidebar-content {
    padding: 1rem;
  }

  .sidebar-tabs {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    background: var(--bg-tertiary);
    border-radius: 12px;
    padding: 0.25rem;
  }

  .sidebar-tab {
    flex: 1;
    background: none;
    border: none;
    color: var(--text-secondary);
    padding: 0.75rem 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 0.9rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }

  .sidebar-tab.active {
    background: var(--accent-primary);
    color: var(--bg-primary);
    box-shadow: 0 2px 8px rgba(0, 212, 170, 0.3);
  }

  .sidebar-tab:hover:not(.active) {
    background: rgba(0, 212, 170, 0.1);
    color: var(--accent-primary);
  }

  .sidebar-panel {
    display: none;
    animation: fadeIn 0.3s ease;
  }

  .sidebar-panel.active {
    display: block;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .sidebar-panel h3 {
    color: var(--text-primary);
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
    text-align: center;
  }

  .sidebar-panel p {
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .sidebar-section {
    background: var(--bg-tertiary);
    border-radius: 12px;
    padding: 1.25rem;
    margin-bottom: 1rem;
    border: 1px solid var(--border-subtle);
  }

  .sidebar-section h4 {
    color: var(--accent-primary);
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .sidebar-section p {
    color: var(--text-secondary);
    line-height: 1.5;
    margin-bottom: 0.5rem;
  }

  .sidebar-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .sidebar-list li {
    color: var(--text-secondary);
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--border-subtle);
    line-height: 1.5;
  }

  .sidebar-list li:last-child {
    border-bottom: none;
  }

  .sidebar-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--accent-primary);
    text-decoration: none;
    padding: 0.5rem 0.75rem;
    border-radius: 8px;
    transition: all 0.2s ease;
    background: rgba(0, 212, 170, 0.1);
  }

  .sidebar-link:hover {
    background: rgba(0, 212, 170, 0.2);
    color: var(--accent-secondary);
    text-decoration: none;
  }

  /* Sidebar Trigger Area */
  .sidebar-trigger {
    position: fixed;
    top: 0;
    left: 0;
    width: 60px;
    height: 100vh;
    z-index: 999;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  .sidebar-trigger:hover {
    backdrop-filter: blur(5px);
  }

  .sidebar-trigger-icon {
    position: absolute;
    left: 15px;
    top: 20px;
    width: 45px;
    height: 45px;
    /* background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%); */
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 20px;
    box-shadow: 0 2px 8px rgba(0, 212, 170, 0.3);
    opacity: 0.8;
    transition: all 0.3s ease;
    animation: pulse 2s infinite;
    cursor: pointer;
  }

  /* Tooltip for sidebar trigger */
  .sidebar-trigger::before {
    content: 'Menu';
    position: absolute;
    left: 70px;
    top: 20px;
    background: var(--bg-tertiary);
    color: var(--text-primary);
    padding: 0.5rem 0.75rem;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 500;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    white-space: nowrap;
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-primary);
    z-index: 1001;
  }

  .sidebar-trigger::after {
    content: '';
    position: absolute;
    left: 65px;
    top: 20px;
    border: 5px solid transparent;
    border-right-color: var(--bg-tertiary);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1001;
  }

  .sidebar-trigger:hover::before,
  .sidebar-trigger:hover::after {
    opacity: 1;
    visibility: visible;
  }

  .sidebar-trigger:hover .sidebar-trigger-icon {
    opacity: 1;
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(0, 212, 170, 0.4);
  }

  @keyframes pulse {
    0%, 100% {
      box-shadow: 0 2px 8px rgba(0, 212, 170, 0.3);
    }
    50% {
      box-shadow: 0 2px 12px rgba(0, 212, 170, 0.5);
    }
  }

  /* Hide trigger when sidebar is open */
  .sidebar.active ~ .sidebar-trigger {
    opacity: 0;
    pointer-events: none;
  }

  /* Active trigger area indicator */
  .sidebar-trigger.active-area {
    backdrop-filter: blur(3px);
  }

  .sidebar-trigger.active-area .sidebar-trigger-icon {
    animation: pulse 1.5s infinite;
  }

  /* Overlay when sidebar is open */
  .sidebar-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }

  .sidebar-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  /* Version Badge */
  .version-badge {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--bg-tertiary);
    color: rgb(114, 112, 112);
    padding: 0.5rem 1rem;
    border: 2px solid rgb(61, 60, 60);
    border-radius: 5px;
    font-size: 0.85rem;
    font-weight: 600;
    z-index: 1000;
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(0, 212, 170, 0.2);
    transition: all 0.3s ease;
    letter-spacing: 0.5px;
  }

  .version-badge:hover {
    background: var(--accent-primary);
    color: var(--bg-primary);
    box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
    transform: translateY(-2px);
  }

  /* Explore Button in Chat Input */
  .explore-button {
    background: var(--bg-tertiary);
    border: 2px solid var(--border-color);
    border-radius: 50%;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary);
    font-size: 1.2rem;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-right: 0.5rem;
    flex-shrink: 0;
  }

  .explore-button:hover {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--accent-primary);
    transform: scale(1.05);
  }

  .explore-button.active {
    background: var(--accent-primary);
    color: var(--bg-primary);
    border-color: var(--accent-primary);
    box-shadow: 0 0 12px rgba(0, 212, 170, 0.4);
  }

  .explore-button.active:hover {
    background: var(--accent-secondary);
    transform: scale(1.05);
  }

  .explore-button i {
    transition: transform 0.3s ease;
  }

  .explore-button.active i {
    transform: rotate(15deg);
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .sidebar {
      width: 100vw;
      left: -100vw;
    }
    
    .sidebar.active {
      left: 0;
    }

    .version-badge {
      top: 15px;
      right: 15px;
      font-size: 0.8rem;
      padding: 0.4rem 0.8rem;
    }

    .version-badge::before {
      content: 'V - 1.1';
    }

    .version-badge {
      font-size: 0; /* Hide the original text */
    }

    .version-badge::before {
      font-size: 0.8rem; /* Show the new text */
    }

    .explore-button {
      width: 44px;
      height: 44px;
      font-size: 1.1rem;
    }

    .send-button {
      width: 44px;
      height: 44px;
    }
  }
</style>
{% endblock %}

{% block content %}
<!-- Sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div class="sidebar-logo">
      <img src="../static/images/logo_ai2.png" alt="CK Intelligence" class="sidebar-logo-img">
      <span class="sidebar-title">CK Intelligence</span>
    </div>
    <button class="sidebar-close" id="sidebarClose">
      <i class="bi bi-x-lg"></i>
    </button>
  </div>
  
  <div class="sidebar-content">
    <div class="sidebar-tabs">
      <button class="sidebar-tab active" data-tab="about">
        <i class="bi bi-info-circle"></i>
        About
      </button>
      <button class="sidebar-tab" data-tab="rules">
        <i class="bi bi-shield-check"></i>
        Rules
      </button>
    </div>
    
    <div class="sidebar-panel active" id="about-panel">
      <h3>About CK Intelligence</h3>
      <p>I'm an AI assistant created by <strong>CK Frozen Fish and Foods (Thailand) Co., Ltd.</strong> to help with your OAC system operations.</p>
      
      <div class="sidebar-section">
        <h4>üè¢ Company</h4>
        <p><strong>CK Frozen Fish and Foods Co., Ltd.</strong> (CK GROUP)</p>
        <p>Leading Thai company specializing in frozen fish and seafood products.</p>
      </div>
      
      <div class="sidebar-section">
        <h4>üìç Locations</h4>
        <p><strong>Head Office:</strong><br>
        109/1 Moo 21, Bangplee-Tamru Road<br>
        Bangpleeyai, Bang Phli, Samut Prakan 10540, Thailand</p>
        
        <p><strong>Chachoengsao Branch:</strong><br>
        81 Moo 17, Khlong Nakhon Nueang Khet<br>
        Mueang Chachoengsao District, Chachoengsao 24000, Thailand</p>
      </div>
      
      <div class="sidebar-section">
        <h4>ü§ñ My Creator</h4>
        <p><strong>Zwe Khant Aung</strong></p>
        <p>Lead Developer & Creator of CK Intelligence</p>
      </div>
      
      <div class="sidebar-section">
        <h4>üåê Website</h4>
        <a href="https://ckfff.net/" target="_blank" class="sidebar-link">
          <i class="bi bi-globe"></i>
          ckfff.net
        </a>
      </div>
    </div>
    
    <div class="sidebar-panel" id="rules-panel">
      <h3>Rules & Guidelines</h3>
      
      <!-- <div class="sidebar-section">
        <h4>üéØ Core Values - GRAB</h4>
        <ul class="sidebar-list">
          <li><strong>G = Growth together:</strong> We grow together with our team, partners, and community</li>
          <li><strong>R = Resilience Always:</strong> We maintain strength through challenges</li>
          <li><strong>A = Adapt and Thrive:</strong> We embrace change and evolve</li>
          <li><strong>B = Being Innovative:</strong> We foster creativity and new ideas</li>
        </ul>
      </div> -->
      
      <!-- <div class="sidebar-section">
        <h4>üí¨ Communication Style</h4>
        <ul class="sidebar-list">
          <li>I respond as "CK Intelligence"</li>
          <li>I use a text typing system for responses</li>
          <li>I avoid using '*' and '#' characters</li>
          <li>I provide data-driven insights</li>
          <li>I'm proud of my CK Frozen Fish and Foods heritage</li>
        </ul>
      </div> -->
      
      <div class="sidebar-section">
        <h6 style="color: rgb(7, 241, 7); text-align: center !important;">Data Access</h6>
        <ul class="sidebar-list">
          <li>- Real-time inventory monitoring</li>
          <li>- Order processing and fulfillment tracking</li>
          <li>- File system analysis and categorization</li>
          <li>- System performance analytics</li>
          <li>- Intelligent data insights </li>
          <li>- Company information knowledge</li>
         
        </ul>
      </div>
      <div class="sidebar-section">
        <h6 style="color: red; text-align: center !important;">Data are not public</h6>
        <ul class="sidebar-list">
          <li>Data are not public and not share to any cloud sources by using encryption method.</li>
         
        </ul>
      </div>
      
      <!-- <div class="sidebar-section">
        <h4>üìû Contact Information</h4>
        <p><strong>Head Office:</strong> +66 2-346-5129</p>
        <p><strong>Chachoengsao:</strong> +66 33-590-826</p>
        <p><strong>Sales:</strong> +66 92 941 6442</p>
        <p><strong>Email:</strong> info@ckfff.net</p>
      </div> -->
    </div>
  </div>
</div>

<!-- Version Badge -->
<div class="version-badge">
  Intelligence Version - 1.1
</div>


<!-- Sidebar Trigger Area -->
<div class="sidebar-trigger" id="sidebarTrigger">
  <div class="sidebar-trigger-icon">
    <i class="bi bi-list"></i>
  </div>
</div>

<div class="ckintelligence-container">
  <!-- Grok-style Header -->
  <div class="ckintelligence-header">
    <div class="ckintelligence-brand">
      <img src="../static/images/logo_ai2.png" alt="CK Intelligence" class="ckintelligence-logo">
      <div class="ckintelligence-title">
        <h1>CK Intelligence</h1>
        <p class="ckintelligence-subtitle">¬© <span id="current-year"></span> C.K. Frozen Fish and Food Co.,Ltd</p>
      </div>
    </div>
  </div>

  <!-- Chat Interface -->
  <div class="chatbot-container">
    <!-- Welcome Section -->
   

        <!-- Database Data Display Area -->
        <div id="databaseDataContainer" style="display: none; margin-top: 2rem;">
          <div class="database-data-panel">
            <div class="data-header">
              <h3 id="dataTitle">Database Data</h3>
              <button class="btn btn-sm btn-outline-secondary" onclick="hideDatabaseData()">Hide</button>
            </div>
            <div id="databaseDataContent" class="data-content">
              <!-- Database data will be loaded here -->
            </div>
          </div>
        </div>
      

    <!-- Chat Messages -->
    <div class="chat-messages" id="chatMessages">
      <div class="welcome-message">
        <h2>Hello! I'm CK Intelligence</h2>
        <p>I'm an AI assistant created by <strong>CK Frozen Fish and Foods (Thailand) Co., Ltd.</strong> to help with your OAC system operations.</p>
        <p>‡∏â‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢ AI ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÇ‡∏î‡∏¢ ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ã‡∏µ‡πÄ‡∏Ñ ‡∏ü‡∏£‡∏∏‡πâ‡∏ï ‡∏ü‡∏¥‡∏ä ‡πÅ‡∏≠‡∏ô‡∏î‡πå ‡∏ü‡∏π‡πâ‡∏î‡∏™‡πå (‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢) ‡∏à‡∏≥‡∏Å‡∏±‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö OAC ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì.</p>

        <div class="suggestions">
          <div class="suggestion-chip" onclick="showInventoryData()">Show Inventory Data</div>
          <div class="suggestion-chip" onclick="showBatchData()">Show Recent Batches</div>
          <div class="suggestion-chip" onclick="showOverviewData()">System Overview</div>
          <div class="suggestion-chip" onclick="showProcessingResults()">Processing Results</div>
          <!-- <div class="suggestion-chip" onclick="showFileSystemData()">File System Analysis</div> -->
          <!-- <div class="suggestion-chip" onclick="showCompanyInfo()">About C.K</div> -->
          <!-- <div class="suggestion-chip" onclick="showCoreValues()">Core Values - GRAB</div> -->
          <!-- <div class="suggestion-chip" onclick="showContactInfo()">Contact Information</div> -->
          <!-- <div class="suggestion-chip" onclick="showCreatorInfo()">About My Creator</div> -->
        </div>

        <!-- <div style="margin-top: 1.5rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
          <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem; text-align: center;">
            <strong>Created by:</strong> Zwe Khant Aung | <strong>Company:</strong> CK Frozen Fish and Foods (Thailand) Co., Ltd.
            <br>
            üìû <strong>Head Office:</strong> +66 2 346 5129 | üìß <strong>Email:</strong> info@ckfff.net
            <br>
            <a href="https://ckfff.net/" target="_blank" style="color: var(--accent-primary); text-decoration: none;">üåê Visit our website</a>
          </p>
        </div> -->

        <!-- Database Data Display Area -->
        <div id="databaseDataContainer" style="display: none; margin-top: 2rem;">
          <div class="database-data-panel">
            <div class="data-header">
              <h3 id="dataTitle">Database Data</h3>
              <button class="btn btn-sm btn-outline-secondary" onclick="hideDatabaseData()">Hide</button>
            </div>
            <div id="databaseDataContent" class="data-content">
              <!-- Database data will be loaded here -->
          </div>
        </div>
      </div>
    </div>

        </div>

    <!-- Chat Input -->
    <div class="chat-input-container">
      <form class="chat-input-form" id="chatForm">
        <textarea
          class="chat-input"
          id="chatInput"
          placeholder="What do you want to know?"
          rows="1"
          maxlength="1000"
        ></textarea>
        <button type="button" class="explore-button" id="exploreToggle" title="Enable Explore Mode - Remove AI limitations">
          <i class="bi bi-compass" id="exploreIcon"></i>
        </button>
        <button type="submit" class="send-button" id="sendButton">
          <i class="bi bi-send"></i>
        </button>
      </form>
    </div>
  </div>
</div>

<script>
  // Global variables
  let isProcessing = false;
  let typingSpeed = 5; // Characters per second (much faster)
  let originalTheme = null; // Store user's original theme preference
  let hasInteracted = false; // Track if user has interacted

  // DOM elements
  const chatForm = document.getElementById('chatForm');
  const chatInput = document.getElementById('chatInput');
  const chatMessages = document.getElementById('chatMessages');
  const sendButton = document.getElementById('sendButton');
  let typingIndicator = null; // Will be created dynamically

  // Handle user interaction - hide ckintelligence-title
  function handleUserInteraction() {
    if (!hasInteracted) {
      hasInteracted = true;
      const ckintelligenceContainer = document.querySelector('.ckintelligence-container');
      if (ckintelligenceContainer) {
        ckintelligenceContainer.classList.add('interacted');
        console.log('User interacted - ckintelligence-title hidden');
      } else {
        console.error('Grok container not found');
      }
    }
  }

  // Show typing indicator dynamically
  function showTypingIndicator() {
    // Remove any existing typing indicator
    hideTypingIndicator();
    
    // Create new typing indicator
    typingIndicator = document.createElement('div');
    typingIndicator.className = 'typing-indicator';
    typingIndicator.innerHTML = `
      <div class="message-avatar">
        <img src="../static/images/logo_ai2.png" alt="CK Intelligence" style="width: 32px; height: 32px; object-fit: contain;">
      </div>
      <span>CK Intelligence is thinking</span>
      <div class="typing-dots">
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
      </div>
    `;
    
    // Append to chat messages so it appears after the last message
    chatMessages.appendChild(typingIndicator);
    
    // Scroll to show the typing indicator
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  // Hide typing indicator
  function hideTypingIndicator() {
    if (typingIndicator && typingIndicator.parentNode) {
      typingIndicator.parentNode.removeChild(typingIndicator);
      typingIndicator = null;
    }
  }

  // CK Intelligence Theme Management
  function initializeCKIntelligenceTheme() {
    try {
      // Store the user's current theme preference
      originalTheme = document.documentElement.getAttribute('data-bs-theme') || 'light';

      // Always switch to dark theme for CK Intelligence
      document.documentElement.setAttribute('data-bs-theme', 'dark');

      console.log('CK Intelligence: Switched to dark theme (original:', originalTheme, ')');

      // Store in sessionStorage as backup
      sessionStorage.setItem('ckintelligence_original_theme', originalTheme);
      sessionStorage.setItem('ckintelligence_active', 'true');
    } catch (error) {
      console.error('Error initializing CK Intelligence theme:', error);
    }
  }

  function restoreOriginalTheme() {
    try {
      let themeToRestore = originalTheme;

      // Fallback to sessionStorage if originalTheme is not set
      if (!themeToRestore) {
        themeToRestore = sessionStorage.getItem('ckintelligence_original_theme') || 'light';
      }

      if (themeToRestore) {
        document.documentElement.setAttribute('data-bs-theme', themeToRestore);
        console.log('CK Intelligence: Restored original theme:', themeToRestore);
      }

      // Clean up sessionStorage
      sessionStorage.removeItem('ckintelligence_original_theme');
      sessionStorage.removeItem('ckintelligence_active');
    } catch (error) {
      console.error('Error restoring original theme:', error);
    }
  }

  // Initialize theme when page loads
  document.addEventListener('DOMContentLoaded', function() {
    // Check if we need to restore theme (e.g., page refresh while on CK Intelligence)
    const wasOnCKIntelligence = sessionStorage.getItem('ckintelligence_active') === 'true';
    const storedOriginalTheme = sessionStorage.getItem('ckintelligence_original_theme');

    if (wasOnCKIntelligence && storedOriginalTheme) {
      // We were on CK Intelligence before, so switch to dark theme
      originalTheme = storedOriginalTheme;
      document.documentElement.setAttribute('data-bs-theme', 'dark');
      console.log('CK Intelligence: Restored dark theme after page refresh (original:', originalTheme, ')');
    } else {
      // Normal page load
      initializeCKIntelligenceTheme();
    }

    // Set current year in copyright
    const currentYearElement = document.getElementById('current-year');
    if (currentYearElement) {
      currentYearElement.textContent = new Date().getFullYear();
    }
  });

  // Restore theme when user leaves the page
  window.addEventListener('beforeunload', function() {
    restoreOriginalTheme();
  });

  // Also restore theme when navigating away (for SPA-like behavior)
  window.addEventListener('pagehide', function() {
    restoreOriginalTheme();
  });

  // Handle browser back/forward navigation
  window.addEventListener('popstate', function() {
    restoreOriginalTheme();
  });

  // Handle internal navigation (e.g., back button in the page)
  function handleNavigationAway() {
    restoreOriginalTheme();
  }

  // Override link clicks to restore theme before navigation
  document.addEventListener('click', function(event) {
    const link = event.target.closest('a');
    if (link && link.href && !link.href.includes('#')) {
      // This is an external link or navigation link
      event.preventDefault();
      restoreOriginalTheme();
      setTimeout(() => {
        window.location.href = link.href;
      }, 100);
    }
  });

  // Auto-resize textarea
  chatInput.addEventListener('input', function() {
    this.style.height = 'auto';
    this.style.height = Math.min(this.scrollHeight, 120) + 'px';
  });

  // Send suggestion chips
  function sendSuggestion(text) {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    chatInput.value = text;
    chatInput.style.height = 'auto';
    chatInput.style.height = chatInput.scrollHeight + 'px';
    sendMessage();
  }

  // Send message
  async function sendMessage() {
    const message = chatInput.value.trim();
    if (!message || isProcessing) return;

    // Hide ckintelligence-title when user sends message
    handleUserInteraction();

    // Add user message
    addMessage('user', message);
    chatInput.value = '';
    chatInput.style.height = 'auto';

    // Show typing indicator immediately after user sends message
    showTypingIndicator();
    isProcessing = true;
    sendButton.disabled = true;

    try {
      const response = await fetch('/ckintelligence', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ 
          message: message,
          explore_mode: window.exploreMode ? window.exploreMode() : false
        })
      });

      const data = await response.json();

      if (data.success) {
        addMessage('bot', data.response);
      } else {
        addMessage('bot', 'Sorry, I encountered an error processing your request. Please try again.');
      }
    } catch (error) {
      console.error('Error:', error);
      addMessage('bot', 'Sorry, I\'m having trouble connecting right now. Please check your connection and try again.');
    } finally {
      hideTypingIndicator();
      isProcessing = false;
      sendButton.disabled = false;
    }
  }

  // Add message to chat
  function addMessage(type, content, useTyping = true) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message message-${type}`;

    const avatar = type === 'user' ? '' : '<img src="../static/images/logo_ai2.png" alt="CK Intelligence" style="width: 32px; height: 32px; object-fit: contain; border-radius: 50%;">';

    if (type === 'user' || !useTyping) {
      // User messages and non-typing bot messages display immediately
      if (type === 'user') {
        messageDiv.innerHTML = `
          <div class="message-avatar">
            ${avatar}
          </div>
          <div class="message-bubble">
            ${content.replace(/\n/g, '<br>')}
          </div>
        `;
      } else {
        // Bot messages without typing effect
        messageDiv.innerHTML = `
          <div class="message-avatar">
            ${avatar}
          </div>
          <div class="message-bubble">
            ${content.replace(/\n/g, '<br>')}
            <button class="copy-button-bottom" onclick="copyMessageText(this)" title="Copy message">
              <i class="bi bi-copy"></i>
            </button>
          </div>
        `;
      }
    } else {
      // Bot messages with typing effect - no background initially
      messageDiv.innerHTML = `
        <div class="message-avatar">
          ${avatar}
        </div>
        <div class="message-bubble typing-bubble">
          <span class="typing-text"></span>
          <button class="copy-button-bottom" onclick="copyMessageText(this)" title="Copy message">
            <i class="bi bi-copy"></i>
          </button>
        </div>
      `;
    }

    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;

    // Remove welcome message if it exists
    const welcomeMessage = chatMessages.querySelector('.welcome-message');
    if (welcomeMessage) {
      welcomeMessage.remove();
    }

    // Apply typing effect for bot messages
    if (type === 'bot' && useTyping) {
      const typingElement = messageDiv.querySelector('.typing-text');
      typeWriter(typingElement, content, typingSpeed, messageDiv);
    }
  }

  // Typewriter effect function
  function typeWriter(element, text, speed = 55, messageDiv = null) {
    let i = 0;
    const formattedText = text.replace(/\n/g, '<br>');

    function type() {
      if (i < formattedText.length) {
        // Handle HTML tags properly
        if (formattedText.substr(i, 4) === '<br>') {
          element.innerHTML += '<br>';
          i += 4;
          // Add shorter pause for line breaks
          setTimeout(type, speed * 1.5);
          return;
        } else {
          element.innerHTML += formattedText.charAt(i);
          i++;
        }

        // Auto-scroll as text appears
        chatMessages.scrollTop = chatMessages.scrollHeight;

        // Add minimal random variation to typing speed for more natural feel
        const randomSpeed = speed + Math.random() * 4 - 2;
        setTimeout(type, Math.max(10, randomSpeed));
      } else {
        // Remove typing cursor when done
        element.classList.remove('typing-text');
        const bubble = element.closest('.message-bubble');
        if (bubble && bubble.classList.contains('typing-bubble')) {
          bubble.classList.remove('typing-bubble');
          
          // Ensure copy button is properly positioned after typing is complete
          const copyButtonBottom = bubble.querySelector('.copy-button-bottom');
          
          if (copyButtonBottom) {
            copyButtonBottom.style.opacity = '0';
            // Small delay to ensure smooth transition
            setTimeout(() => {
              copyButtonBottom.style.opacity = '';
            }, 100);
          }
        }

        // Add suggestion chips after bot response is complete
        if (messageDiv) {
          addSuggestionChipsAfterMessage(messageDiv, text);
        }
      }
    }

    type();
  }

  // Add suggestion chips after bot message
  function addSuggestionChipsAfterMessage(messageDiv, messageContent) {
    // Small delay to ensure message is fully rendered
    setTimeout(() => {
      const suggestionsDiv = document.createElement('div');
      suggestionsDiv.className = 'response-suggestions';

      // Check if this is a batch summary response and add clickable batch names
      if (messageContent && messageContent.includes('Batch ') && messageContent.includes('[Click to view details]')) {
        // Extract batch tokens and make them clickable
        let modifiedContent = messageContent;
        const batchPattern = /Batch\s+([a-zA-Z0-9]+\.\.\.)/g;
        const matches = [...modifiedContent.matchAll(batchPattern)];

        for (const match of matches) {
          const batchToken = match[1];
          const clickableBatch = `<span class="clickable-batch" onclick="sendSuggestion('Show batch ${batchToken} details')" style="cursor: pointer; color: var(--accent-primary); text-decoration: underline;">${batchToken}</span>`;
          modifiedContent = modifiedContent.replace(match[0], `Batch ${clickableBatch}`);
        }

        suggestionsDiv.innerHTML = `
          <div class="batch-details-container">
            <div class="batch-content">${modifiedContent.replace(/\n/g, '<br>')}</div>
          </div>
          <div class="suggestions">
            <div class="suggestion-chip" onclick="sendSuggestion('How many we have for Full MC')">How many we have for Full MC</div>
            <div class="suggestion-chip" onclick="sendSuggestion('How many we have for Full KG')">How many we have for Full KG</div>
            <div class="suggestion-chip" onclick="sendSuggestion('What is the total inventory')">What is the total inventory</div>
          </div>
        `;
      } else {
        suggestionsDiv.innerHTML = `
          <div class="suggestions">
            <div class="suggestion-chip" onclick="sendSuggestion('How many we have for Full MC')">How many we have for Full MC</div>
            <div class="suggestion-chip" onclick="sendSuggestion('How many we have for Full KG')">How many we have for Full KG</div>
            <div class="suggestion-chip" onclick="sendSuggestion('Show me batch summary')">Show me batch summary</div>
            <div class="suggestion-chip" onclick="sendSuggestion('What is the total inventory')">What is the total inventory</div>
          </div>
        `;
      }

      // Insert after the message
      messageDiv.parentNode.insertBefore(suggestionsDiv, messageDiv.nextSibling);

      // Auto-scroll to show the suggestions
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }, 500);
  }

  // Form submission
  chatForm.addEventListener('submit', function(e) {
    e.preventDefault();
    sendMessage();
  });

  // Enter key handling
  chatInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });

  // Database Data Functions
  let currentDatabaseData = null;

  async function fetchDatabaseData(endpoint) {
    try {
      const response = await fetch(endpoint);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const data = await response.json();
      return data;
    } catch (error) {
      console.error('Error fetching database data:', error);
      throw error;
    }
  }

  function showLoadingSpinner() {
    const content = document.getElementById('databaseDataContent');
    content.innerHTML = `
      <div class="loading-spinner">
        <i class="bi bi-arrow-clockwise"></i>
        <span>Loading database data...</span>
      </div>
    `;
  }

  function showErrorMessage(message) {
    const content = document.getElementById('databaseDataContent');
    content.innerHTML = `
      <div class="error-message">
        <i class="bi bi-exclamation-triangle"></i>
        <p>${message}</p>
      </div>
    `;
  }

  function formatNumber(num) {
    if (num === null || num === undefined) return '0';
    return num.toLocaleString();
  }

  function formatDate(dateString) {
    if (!dateString) return 'N/A';
    try {
      return new Date(dateString).toLocaleDateString();
    } catch (e) {
      return dateString;
    }
  }

  function showDatabaseData(data, title) {
    document.getElementById('dataTitle').textContent = title;
    document.getElementById('databaseDataContainer').style.display = 'block';
    currentDatabaseData = data;

    // Scroll to show the data
    const container = document.getElementById('databaseDataContainer');
    container.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  function hideDatabaseData() {
    document.getElementById('databaseDataContainer').style.display = 'none';
    currentDatabaseData = null;
  }

  // Inventory Data Display
  async function showInventoryData() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    try {
      showLoadingSpinner();
      const data = await fetchDatabaseData('/api/ckintelligence/inventory');
      showDatabaseData(data, 'Inventory Data');

      const content = document.getElementById('databaseDataContent');

      // Inventory Summary Cards
      const statusSummary = data.status_summary || {};
      content.innerHTML = `
        <div class="data-section">
          <h4>üìä Inventory Summary</h4>
          <div class="data-grid">
            <div class="data-card">
              <h5>Total Orders</h5>
              <div class="data-value">${formatNumber(statusSummary.total_orders)}</div>
              <div class="data-label">All Orders</div>
            </div>
            <div class="data-card">
              <h5 class="status-full">Fully Fulfilled</h5>
              <div class="data-value">${formatNumber(statusSummary.full_orders)}</div>
              <div class="data-label">Full Orders</div>
            </div>
            <div class="data-card">
              <h5 class="status-not-full">Partially Fulfilled</h5>
              <div class="data-value">${formatNumber(statusSummary.not_full_orders)}</div>
              <div class="data-label">Not Full Orders</div>
            </div>
            <div class="data-card">
              <h5 class="status-not-have">Not Available</h5>
              <div class="data-value">${formatNumber(statusSummary.not_have_orders)}</div>
              <div class="data-label">Not Have Orders</div>
            </div>
          </div>
        </div>

        <div class="data-section">
          <h4>üêü Fish Inventory Details</h4>
          <table class="inventory-table">
            <thead>
              <tr>
                <th>Fish Name</th>
                <th>Pack Size</th>
                <th>Ordered</th>
                <th>Stock</th>
                <th>Fulfilled</th>
                <th>Shortfall</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${data.inventory_by_fish.map(item => `
                <tr>
                  <td>${item.fish_name}</td>
                  <td>${item.packed_size}</td>
                  <td>${formatNumber(item.total_ordered)}</td>
                  <td>${formatNumber(item.total_stock)}</td>
                  <td>${formatNumber(item.total_fulfilled)}</td>
                  <td>${formatNumber(item.total_shortfall)}</td>
                  <td class="${item.total_shortfall > 0 ? 'status-not-full' : 'status-full'}">
                    ${item.total_shortfall > 0 ? 'Shortfall' : 'Full'}
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;

      // Also send to chat as AI response
      addMessage('user', 'Show me the inventory data');
      setTimeout(() => {
        addMessage('bot', `Here's your current inventory data:\n\nüìä **Summary:**\n- Total Orders: ${formatNumber(statusSummary.total_orders)}\n- Full Orders: ${formatNumber(statusSummary.full_orders)}\n- Not Full Orders: ${formatNumber(statusSummary.not_full_orders)}\n\nüêü **Fish Types:** ${data.inventory_by_fish.length} different fish types in inventory.`);
      }, 500);

    } catch (error) {
      showErrorMessage('Failed to load inventory data. Please try again.');
      console.error('Error loading inventory data:', error);
    }
  }

  // Batch Data Display
  async function showBatchData() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    try {
      showLoadingSpinner();
      const data = await fetchDatabaseData('/api/ckintelligence/batches');
      showDatabaseData(data, 'Recent Batches');

      const content = document.getElementById('databaseDataContent');
      const batches = data.batches || [];

      content.innerHTML = `
        <div class="data-section">
          <h4>üì¶ Recent Batch Processing Sessions</h4>
          <div class="data-grid">
            ${batches.slice(0, 6).map((batch, index) => `
              <div class="data-card">
                <h5>Batch ${batch.session_token?.substring(0, 8) || batch.id}</h5>
                <div class="data-value">${batch.processing_type}</div>
                <div class="data-label">Type</div>
                <div style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--text-secondary);">
                  ${formatDate(batch.created_at)}<br>
                  ${formatNumber(batch.total_items)} items<br>
                  ${formatNumber(batch.total_kg)} kg
                </div>
              </div>
            `).join('')}
          </div>
        </div>

        <div class="data-section">
          <h4>üìã Batch Details</h4>
          <table class="inventory-table">
            <thead>
              <tr>
                <th>Batch ID</th>
                <th>Type</th>
                <th>Created</th>
                <th>Total Items</th>
                <th>Total KG</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${batches.map(batch => `
                <tr>
                  <td>${batch.session_token?.substring(0, 12) || batch.id}</td>
                  <td>${batch.processing_type}</td>
                  <td>${formatDate(batch.created_at)}</td>
                  <td>${formatNumber(batch.total_items)}</td>
                  <td>${formatNumber(batch.total_kg)}</td>
                  <td>
                    <span class="status-full">${batch.not_have_items === 0 ? 'Complete' : 'In Progress'}</span>
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;

      // Send to chat
      addMessage('user', 'Show me recent batch data');
      setTimeout(() => {
        addMessage('bot', `Here are your recent batches:\n\nüì¶ **Latest ${batches.length} batches:**\n${batches.slice(0, 3).map(b => `- ${b.session_token?.substring(0, 8) || b.id}: ${b.processing_type}, ${formatNumber(b.total_items)} items`).join('\n')}`);
      }, 500);

    } catch (error) {
      showErrorMessage('Failed to load batch data. Please try again.');
      console.error('Error loading batch data:', error);
    }
  }

  // Overview Data Display
  async function showOverviewData() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    try {
      showLoadingSpinner();
      const data = await fetchDatabaseData('/api/ckintelligence/overview');
      showDatabaseData(data, 'System Overview');

      const content = document.getElementById('databaseDataContent');
      const sessionStats = data.session_stats || {};
      const fileStats = data.file_stats || {};
      const resultsStats = data.results_stats || {};
      const recentActivity = data.recent_activity || {};

      content.innerHTML = `
        <div class="data-section">
          <h4>üìä System Statistics</h4>
          <div class="data-grid">
            <div class="data-card">
              <h5>Processing Sessions</h5>
              <div class="data-value">${formatNumber(sessionStats.total_sessions)}</div>
              <div class="data-label">Total Sessions</div>
            </div>
            <div class="data-card">
              <h5>Batch Sessions</h5>
              <div class="data-value">${formatNumber(sessionStats.batch_sessions)}</div>
              <div class="data-label">Batch Type</div>
            </div>
            <div class="data-card">
              <h5>Items Processed</h5>
              <div class="data-value">${formatNumber(sessionStats.total_items_processed)}</div>
              <div class="data-label">Total Items</div>
            </div>
            <div class="data-card">
              <h5>KG Processed</h5>
              <div class="data-value">${formatNumber(sessionStats.total_kg_processed)}</div>
              <div class="data-label">Total Weight</div>
            </div>
          </div>
        </div>

        <div class="data-section">
          <h4>üìÅ File Management</h4>
          <div class="data-grid">
            <div class="data-card">
              <h5>Total Files</h5>
              <div class="data-value">${formatNumber(fileStats.total_files)}</div>
              <div class="data-label">All Files</div>
            </div>
            <div class="data-card">
              <h5>Order Files</h5>
              <div class="data-value">${formatNumber(fileStats.order_files)}</div>
              <div class="data-label">Customer Orders</div>
            </div>
            <div class="data-card">
              <h5>Stock Files</h5>
              <div class="data-value">${formatNumber(fileStats.stock_files)}</div>
              <div class="data-label">Inventory Files</div>
            </div>
            <div class="data-card">
              <h5>Revised Files</h5>
              <div class="data-value">${formatNumber(fileStats.revised_files)}</div>
              <div class="data-label">Updated Files</div>
            </div>
          </div>
        </div>

        <div class="data-section">
          <h4>üêü Processing Results</h4>
          <div class="data-grid">
            <div class="data-card">
              <h5>Fish Types</h5>
              <div class="data-value">${formatNumber(resultsStats.unique_fish_types)}</div>
              <div class="data-label">Unique Species</div>
            </div>
            <div class="data-card">
              <h5>Ordered Cartons</h5>
              <div class="data-value">${formatNumber(resultsStats.total_ordered_cartons)}</div>
              <div class="data-label">Customer Orders</div>
            </div>
            <div class="data-card">
              <h5>Stock Cartons</h5>
              <div class="data-value">${formatNumber(resultsStats.total_stock_cartons)}</div>
              <div class="data-label">Available Stock</div>
            </div>
            <div class="data-card">
              <h5>Fulfilled Orders</h5>
              <div class="data-value">${formatNumber(resultsStats.total_fulfilled_cartons)}</div>
              <div class="data-label">Completed Orders</div>
            </div>
          </div>
        </div>
      `;

      // Send to chat
      addMessage('user', 'Show me system overview');
      setTimeout(() => {
        addMessage('bot', `Here's your system overview:\n\nüìä **Sessions:** ${formatNumber(sessionStats.total_sessions)} total\nüìÅ **Files:** ${formatNumber(fileStats.total_files)} uploaded\nüêü **Fish Types:** ${formatNumber(resultsStats.unique_fish_types)} species\nüì¶ **Orders:** ${formatNumber(resultsStats.total_ordered_cartons)} cartons ordered`);
      }, 500);

    } catch (error) {
      showErrorMessage('Failed to load overview data. Please try again.');
      console.error('Error loading overview data:', error);
    }
  }

  // Processing Results Display
  async function showProcessingResults() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    try {
      showLoadingSpinner();
      const data = await fetchDatabaseData('/api/ckintelligence/processing-results');
      showDatabaseData(data, 'Processing Results');

      const content = document.getElementById('databaseDataContent');
      const results = data.results || [];

      // Group by fish name for better display
      const groupedResults = {};
      results.forEach(result => {
        const key = result.fish_name;
        if (!groupedResults[key]) {
          groupedResults[key] = [];
        }
        groupedResults[key].push(result);
      });

      content.innerHTML = `
        <div class="data-section">
          <h4>üìã Processing Results Summary</h4>
          <p style="color: var(--text-secondary); margin-bottom: 1rem;">
            Showing ${results.length} processing results across ${Object.keys(groupedResults).length} fish types
          </p>
        </div>

        ${Object.entries(groupedResults).slice(0, 10).map(([fishName, fishResults]) => `
          <div class="data-section">
            <h4>${fishName}</h4>
            <table class="inventory-table">
              <thead>
                <tr>
                  <th>Pack Size</th>
                  <th>Ordered</th>
                  <th>Stock</th>
                  <th>Fulfilled</th>
                  <th>Shortfall</th>
                  <th>Status</th>
                  <th>Required KG</th>
                </tr>
              </thead>
              <tbody>
                ${fishResults.map(result => `
                  <tr>
                    <td>${result.packed_size}</td>
                    <td>${formatNumber(result.order_carton)}</td>
                    <td>${formatNumber(result.stock_carton)}</td>
                    <td>${formatNumber(result.can_fulfill_carton)}</td>
                    <td>${formatNumber(result.shortfall)}</td>
                    <td class="${result.status === 'Full' ? 'status-full' : result.status === 'Not Full' ? 'status-not-full' : 'status-not-have'}">
                      ${result.status}
                    </td>
                    <td>${formatNumber(result.required_kg)}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          </div>
        `).join('')}
      `;

      // Send to chat
      addMessage('user', 'Show me processing results');
      setTimeout(() => {
        addMessage('bot', `Here are your processing results:\n\nüìã **Summary:**\n- Total Results: ${results.length}\n- Fish Types: ${Object.keys(groupedResults).length}\n- Sample: ${Object.keys(groupedResults)[0]} with ${groupedResults[Object.keys(groupedResults)[0]].length} pack sizes`);
      }, 500);

    } catch (error) {
      showErrorMessage('Failed to load processing results. Please try again.');
      console.error('Error loading processing results:', error);
    }
  }

  // File System Data Display
  async function showFileSystemData() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    try {
      showLoadingSpinner();
      const data = await fetchDatabaseData('/api/ckintelligence/files');
      showDatabaseData(data, 'File System Analysis');

      const content = document.getElementById('databaseDataContent');

      // File system overview
      const totalFiles = data.total_files || 0;
      const totalSize = data.total_size_mb || 0;
      const categories = data.categories || {};

      content.innerHTML = `
        <div class="data-section">
          <h4>üìÅ File System Overview</h4>
          <div class="data-grid">
            <div class="data-card">
              <h5>Total Files</h5>
              <div class="data-value">${formatNumber(totalFiles)}</div>
              <div class="data-label">All Files</div>
            </div>
            <div class="data-card">
              <h5>Total Size</h5>
              <div class="data-value">${totalSize.toFixed(1)}</div>
              <div class="data-label">MB</div>
            </div>
            <div class="data-card">
              <h5>Last Updated</h5>
              <div class="data-value">${new Date().toLocaleDateString()}</div>
              <div class="data-label">Analysis Time</div>
            </div>
          </div>
        </div>

        <div class="data-section">
          <h4>üìÇ File Categories</h4>
          <div class="data-grid">
            <div class="data-card clickable-card" onclick="showFilesByCategory('stock_files')">
              <h5>üì¶ Stock Files</h5>
              <div class="data-value">${formatNumber(categories.stock_files_summary?.count || 0)}</div>
              <div class="data-label">${(categories.stock_files_summary?.total_size_mb || 0).toFixed(1)} MB</div>
            </div>
            <div class="data-card clickable-card" onclick="showFilesByCategory('import_stock_files')">
              <h5>üì• Import Stock Files</h5>
              <div class="data-value">${formatNumber(categories.import_stock_files_summary?.count || 0)}</div>
              <div class="data-label">${(categories.import_stock_files_summary?.total_size_mb || 0).toFixed(1)} MB</div>
            </div>
            <div class="data-card clickable-card" onclick="showFilesByCategory('extra_load_stock_files')">
              <h5>‚ö° Extra-Load Stock Files</h5>
              <div class="data-value">${formatNumber(categories.extra_load_stock_files_summary?.count || 0)}</div>
              <div class="data-label">${(categories.extra_load_stock_files_summary?.total_size_mb || 0).toFixed(1)} MB</div>
            </div>
            <div class="data-card clickable-card" onclick="showFilesByCategory('order_files')">
              <h5>üìã Order Files</h5>
              <div class="data-value">${formatNumber(categories.order_files_summary?.count || 0)}</div>
              <div class="data-label">${(categories.order_files_summary?.total_size_mb || 0).toFixed(1)} MB</div>
            </div>
          </div>
        </div>

        <div class="data-section">
          <h4>‚ö†Ô∏è System Status</h4>
          <div class="data-grid">
            <div class="data-card">
              <h5>Orphan Files</h5>
              <div class="data-value ${categories.orphan_files_summary?.count > 0 ? 'status-not-have' : 'status-full'}">
                ${formatNumber(categories.orphan_files_summary?.count || 0)}
              </div>
              <div class="data-label">Not in Database</div>
            </div>
            <div class="data-card">
              <h5>Uncategorized</h5>
              <div class="data-value ${categories.uncategorized_summary?.count > 0 ? 'status-not-full' : 'status-full'}">
                ${formatNumber(categories.uncategorized_summary?.count || 0)}
              </div>
              <div class="data-label">Unclassified Files</div>
            </div>
          </div>
        </div>

        <div class="data-section">
          <h4>üìÑ Recent Files</h4>
          <table class="inventory-table">
            <thead>
              <tr>
                <th>Filename</th>
                <th>Size</th>
                <th>Type</th>
                <th>Modified</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${(data.all_files || [])
                .sort((a, b) => b.modified_time - a.modified_time)
                .slice(0, 10)
                .map(file => `
                  <tr>
                    <td>${file.filename}</td>
                    <td>${file.file_size_mb.toFixed(1)} MB</td>
                    <td>${file.file_extension}</td>
                    <td>${file.modified_date}</td>
                    <td>
                      <span class="${file.in_database ? 'status-full' : 'status-not-have'}">
                        ${file.in_database ? 'In DB' : 'Orphan'}
                      </span>
                    </td>
                  </tr>
                `).join('')}
            </tbody>
          </table>
        </div>
      `;

      // Send to chat
      addMessage('user', 'Show me file system analysis');
      setTimeout(() => {
        addMessage('bot', `Here's your file system analysis:\n\nüìÅ **Overview:**\n- Total Files: ${formatNumber(totalFiles)}\n- Total Size: ${totalSize.toFixed(1)} MB\n\nüìÇ **Categories:**\n- Stock Files: ${formatNumber(categories.stock_files_summary?.count || 0)}\n- Import Stock Files: ${formatNumber(categories.import_stock_files_summary?.count || 0)}\n- Extra-Load Stock Files: ${formatNumber(categories.extra_load_stock_files_summary?.count || 0)}\n- Order Files: ${formatNumber(categories.order_files_summary?.count || 0)}\n\n‚ö†Ô∏è **Issues:** ${formatNumber(categories.orphan_files_summary?.count || 0)} orphan files`);
      }, 500);

    } catch (error) {
      showErrorMessage('Failed to load file system data. Please try again.');
      console.error('Error loading file system data:', error);
    }
  }

  // Show files by specific category
  async function showFilesByCategory(category) {
    try {
      showLoadingSpinner();
      const data = await fetchDatabaseData(`/api/ckintelligence/files/category/${category}`);
      showDatabaseData(data, `${category.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())} Files`);

      const content = document.getElementById('databaseDataContent');
      const files = data.files || [];
      const summary = data.summary || {};

      const categoryTitles = {
        'stock_files': 'üì¶ Regular Stock Files',
        'import_stock_files': 'üì• Import Stock Files',
        'extra_load_stock_files': '‚ö° Extra-Load Stock Files',
        'order_files': 'üìã Order Files',
        'orphan_files': '‚ö†Ô∏è Orphan Files',
        'uncategorized': '‚ùì Uncategorized Files'
      };

      content.innerHTML = `
        <div class="data-section">
          <h4>${categoryTitles[category] || category}</h4>
          <div class="data-grid">
            <div class="data-card">
              <h5>Total Files</h5>
              <div class="data-value">${formatNumber(data.count || 0)}</div>
              <div class="data-label">In Category</div>
            </div>
            <div class="data-card">
              <h5>Total Size</h5>
              <div class="data-value">${(summary.total_size_mb || 0).toFixed(1)}</div>
              <div class="data-label">MB</div>
            </div>
            <div class="data-card">
              <h5>File Types</h5>
              <div class="data-value">${(summary.file_types || []).length}</div>
              <div class="data-label">Extensions</div>
            </div>
          </div>
        </div>

        <div class="data-section">
          <h4>üìÑ Files in Category</h4>
          <table class="inventory-table">
            <thead>
              <tr>
                <th>Original Name</th>
                <th>Stored Name</th>
                <th>Size</th>
                <th>Uploaded</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${files.map(file => `
                <tr>
                  <td>${file.original_filename || file.filename}</td>
                  <td>${file.filename}</td>
                  <td>${file.file_size_mb.toFixed(1)} MB</td>
                  <td>${file.uploaded_at ? new Date(file.uploaded_at).toLocaleDateString() : file.created_date}</td>
                  <td>
                    <span class="${file.in_database ? 'status-full' : 'status-not-have'}">
                      ${file.in_database ? 'In Database' : 'Orphan'}
                    </span>
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;

      // Send to chat
      addMessage('user', `Show me ${category.replace('_', ' ')} files`);
      setTimeout(() => {
        addMessage('bot', `Here are your ${category.replace('_', ' ')} files:\n\nüìÇ **Category:** ${categoryTitles[category]}\n- Total Files: ${formatNumber(data.count || 0)}\n- Total Size: ${(summary.total_size_mb || 0).toFixed(1)} MB\n- File Types: ${(summary.file_types || []).join(', ')}`);
      }, 500);

    } catch (error) {
      showErrorMessage('Failed to load category files. Please try again.');
      console.error('Error loading category files:', error);
    }
  }

  // Company Information Display
  function showCompanyInfo() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    showDatabaseData(null, 'About CK Frozen Fish and Foods');

    const content = document.getElementById('databaseDataContent');

    content.innerHTML = `
      <div class="data-section">
        <h4>üè¢ About CK Frozen Fish and Foods Co., Ltd.</h4>
        <div class="data-grid">
          <div class="data-card">
            <h5>Company Details</h5>
            <div class="data-value">CK Frozen Fish and Foods Co., Ltd.</div>
            <div class="data-label">Full Company Name</div>
          </div>
          <div class="data-card">
            <h5>Also Known As</h5>
            <div class="data-value">CK GROUP</div>
            <div class="data-label">Alternative Name</div>
          </div>
          <div class="data-card">
            <h5>Location</h5>
            <div class="data-value">Thailand</div>
            <div class="data-label">Headquarters</div>
          </div>
          <div class="data-card">
            <h5>Industry</h5>
            <div class="data-value">Frozen Fish & Seafood</div>
            <div class="data-label">Processing & Export</div>
          </div>
          <div class="data-card">
            <h5>Website</h5>
            <div class="data-value"><a href="https://ckfff.net/" target="_blank" style="color: var(--accent-primary);">ckfff.net</a></div>
            <div class="data-label">Company Website</div>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üìç Locations & Contact Information</h4>
        <div class="data-grid">
          <div class="data-card">
            <h5>üè¢ Head Office</h5>
            <div class="data-value">109/1 Moo 21, Bangplee-Tamru Road</div>
            <div class="data-label">Bangpleeyai, Bang Phli, Samut Prakan 10540, Thailand</div>
            <div class="data-value">üìû +66 2-346-5129</div>
            <div class="data-value">üìß info@ckfff.net</div>
          </div>
          <div class="data-card">
            <h5>üè≠ Chachoengsao Branch</h5>
            <div class="data-value">81 Moo 17, Khlong Nakhon Nueang Khet</div>
            <div class="data-label">Mueang Chachoengsao District, Chachoengsao 24000, Thailand</div>
            <div class="data-value">üìû +66 33-590-826</div>
            <div class="data-value">üìû +66 33-590-827</div>
            <div class="data-value">üìß adm1.ckgroup@gmail.com</div>
          </div>
          <div class="data-card">
            <h5>üíº Sales Contact</h5>
            <div class="data-value">üìû +66 92 941 6442</div>
            <div class="data-label">Sales Department</div>
          </div>
          <div class="data-card">
            <h5>üïí Business Hours</h5>
            <div class="data-value">Monday - Friday</div>
            <div class="data-label">8:00 AM - 5:00 PM (Thailand Time)</div>
            <div class="data-value">üö® Emergency Contact: Available 24/7</div>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üåê Website Structure & Services</h4>
        <div style="background: var(--bg-secondary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color);">
          <p style="color: var(--text-primary); margin-bottom: 1rem; font-weight: 600;">Main Website Sections:</p>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <div>
              <h6 style="color: var(--accent-primary); margin-bottom: 0.5rem;">üìã Core Sections</h6>
              <ul style="color: var(--text-secondary); margin: 0; padding-left: 1.5rem; font-size: 0.9rem;">
                <li>Home</li>
                <li>About Us (Company Information, Certification)</li>
                <li>CK GROUP</li>
                <li>Activities & News</li>
                <li>Contact Us</li>
              </ul>
            </div>
            <div>
              <h6 style="color: var(--accent-primary); margin-bottom: 0.5rem;">üõ†Ô∏è Our Services</h6>
              <ul style="color: var(--text-secondary); margin: 0; padding-left: 1.5rem; font-size: 0.9rem;">
                <li>Processing Service</li>
                <li>Freezing Service</li>
                <li>Packing and Repacking Services</li>
                <li>Cold Storage Services</li>
                <li>Logistics Sourcing Services</li>
                <li>Terms of Services</li>
              </ul>
            </div>
            <div>
              <h6 style="color: var(--accent-primary); margin-bottom: 0.5rem;">üì¶ Products</h6>
              <ul style="color: var(--text-secondary); margin: 0; padding-left: 1.5rem; font-size: 0.9rem;">
                <li>Frozen Fish</li>
                <li>Frozen Shrimp</li>
                <li>Dry & Smoked Products</li>
                <li>Halal Frozen Poultry</li>
                <li>Seasonal Fruits</li>
                <li>Vegetables</li>
                <li>Ready To Eat</li>
                <li>Beverages</li>
                <li>Condiments</li>
                <li>Rice & Legumes</li>
                <li>Cosmetics</li>
                <li>Snacks</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üìÖ Recent Company Activities (2025)</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem;">
          <div class="data-card">
            <h5>üéâ Happy New Year 2025 Event</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Held on February 22, 2025, at the Chachoengsao and Samut Prakan branches. Mr. Shahzada Mohammad Ali Khan chaired the event, attended by Ms. Jaruwan, Mr. Montree, and staff.
            </p>
          </div>
          <div class="data-card">
            <h5>üì∫ Media Interview</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Mr. Mohammad Ali Khan was interviewed by Bangladesh's Channel i News, recognized for success in global business from Thailand.
            </p>
          </div>
          <div class="data-card">
            <h5>üéì Training Session</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Focused on organizational loyalty awareness, delivered by Lecturer Kasemsit Phukrongta.
            </p>
          </div>
          <div class="data-card">
            <h5>‚úàÔ∏è Annual Trip</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Company's annual trip took place in Malaysia in 2024.
            </p>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üéØ Business Focus & Services</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem;">
          <div class="data-card">
            <h5>üêü Frozen Fish Products</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Premium quality frozen fish for both domestic and international markets
            </p>
          </div>
          <div class="data-card">
            <h5>‚öôÔ∏è Seafood Processing</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Advanced processing techniques to maintain freshness and quality
            </p>
          </div>
          <div class="data-card">
            <h5>üö¢ Export Services</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Global distribution network serving customers around the world
            </p>
          </div>
          <div class="data-card">
            <h5>‚úÖ Quality Assurance</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Strict quality control measures to ensure product excellence
            </p>
          </div>
          <div class="data-card">
            <h5>üí° Innovation</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Continuous improvement in processing technology and product development
            </p>
          </div>
          <div class="data-card">
            <h5>üöö Logistics Sourcing</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
              Supply chain optimization for swift and reliable delivery of frozen food products
            </p>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>ü§ñ CK Intelligence Connection</h4>
        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
          CK Intelligence was created by CK Frozen Fish and Foods (Thailand) Co., Ltd. as part of our commitment to technological innovation in the seafood processing industry.
        </p>
        <div class="data-card" style="text-align: center;">
          <h5>Our Mission</h5>
          <p style="color: var(--text-primary); margin: 0.5rem 0; font-size: 0.95rem;">
            "Providing high-quality frozen fish products worldwide while leveraging technology to streamline operations and improve efficiency."
          </p>
        </div>
      </div>
    `;

    // Send to chat
    addMessage('user', 'Tell me about CK Frozen Fish and Foods');
    setTimeout(() => {
      addMessage('bot', `CK Frozen Fish and Foods Co., Ltd. (also referred to as CK GROUP) is a leading Thai company specializing in frozen fish and seafood products. We're committed to providing high-quality frozen fish products to customers worldwide.

üè¢ **Company Overview**:
‚Ä¢ Full Name: CK Frozen Fish and Foods Co., Ltd.
‚Ä¢ Also Known As: CK GROUP
‚Ä¢ Location: Thailand
‚Ä¢ Industry: Frozen Fish and Seafood Processing & Export
‚Ä¢ Website: https://ckfff.net/

üìç **Locations & Contact**:
‚Ä¢ **Head Office**: 109/1 Moo 21, Bangplee-Tamru Road, Bangpleeyai, Bang Phli, Samut Prakan 10540, Thailand
  üìû Phone: +66 2-346-5129 | üìß Email: info@ckfff.net
‚Ä¢ **Chachoengsao Branch**: 81 Moo 17, Khlong Nakhon Nueang Khet, Mueang Chachoengsao District, Chachoengsao 24000, Thailand
  üìû Phone: +66 33-590-826, +66 33-590-827 | üìß Email: adm1.ckgroup@gmail.com
‚Ä¢ **Sales Contact**: üìû +66 92 941 6442

üåê **Website Structure**:
Our website (ckfff.net) includes sections for About Us, CK GROUP, Our Services, Products, Activities & News, and Contact Us. We offer comprehensive services including Processing, Freezing, Packing/Repacking, Cold Storage, and Logistics Sourcing.

üìÖ **Recent Activities (2025)**:
‚Ä¢ Happy New Year 2025 Event (February 22, 2025) chaired by Mr. Shahzada Mohammad Ali Khan
‚Ä¢ Media interview with Bangladesh's Channel i News
‚Ä¢ Training session on organizational loyalty awareness
‚Ä¢ Annual company trip to Malaysia (2024)

üéØ **Business Focus**:
‚Ä¢ Frozen Fish Products for domestic and international markets
‚Ä¢ Advanced seafood processing techniques
‚Ä¢ Global export services and distribution
‚Ä¢ Strict quality assurance measures
‚Ä¢ Continuous innovation in processing technology
‚Ä¢ Logistics sourcing and supply chain optimization

ü§ñ **Our Technology**: I was created by CK Frozen Fish and Foods to help streamline operations and provide intelligent insights for our OrderAI system!`);
    }, 500);
  }

  // Core Values Display
  function showCoreValues() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    showDatabaseData(null, 'Our Core Values - GRAB');

    const content = document.getElementById('databaseDataContent');

    content.innerHTML = `
      <div class="data-section">
        <h4>üéØ CK Frozen Fish and Foods Core Values</h4>
        <p style="color: var(--text-secondary); margin-bottom: 2rem; text-align: center; font-size: 1.1rem;">
          Our core values are encapsulated in <strong style="color: var(--accent-primary); font-size: 1.2rem;">GRAB</strong> -
          the foundation of everything we do and guide our commitment to excellence.
        </p>
      </div>

      <div class="data-section">
        <h4 style="text-align: center; color: var(--accent-primary); margin-bottom: 2rem;">GRAB</h4>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
          <!-- G = Growth together -->
          <div class="data-card" style="text-align: center; background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%); border: 2px solid var(--accent-primary);">
            <div style="font-size: 3rem; font-weight: 900; color: var(--accent-primary); margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">G</div>
            <h4 style="color: var(--accent-primary); margin-bottom: 0.5rem;">Growth together</h4>
            <p style="color: var(--text-primary); font-weight: 500; margin-bottom: 0.5rem;">
              We grow together with our team, partners, and community
            </p>
            <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
              Fostering collaboration and mutual development for collective success
            </p>
          </div>

          <!-- R = RESILIENCE ALWAYS -->
          <div class="data-card" style="text-align: center; background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(34, 197, 94, 0.1) 100%); border: 2px solid #22c55e;">
            <div style="font-size: 3rem; font-weight: 900; color: #22c55e; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">R</div>
            <h4 style="color: #22c55e; margin-bottom: 0.5rem;">RESILIENCE ALWAYS</h4>
            <p style="color: var(--text-primary); font-weight: 500; margin-bottom: 0.5rem;">
              We maintain strength and determination through challenges
            </p>
            <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
              Our resilience is our greatest asset in overcoming obstacles and emerging victorious
            </p>
          </div>

          <!-- A = ADAPT AND THRIVE -->
          <div class="data-card" style="text-align: center; background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(245, 158, 11, 0.1) 100%); border: 2px solid #f59e0b;">
            <div style="font-size: 3rem; font-weight: 900; color: #f59e0b; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">A</div>
            <h4 style="color: #f59e0b; margin-bottom: 0.5rem;">ADAPT AND THRIVE</h4>
            <p style="color: var(--text-primary); font-weight: 500; margin-bottom: 0.5rem;">
              We embrace change and continuously evolve
            </p>
            <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
              Flexibility and adaptability are key to our long-term success in the dynamic seafood industry
            </p>
          </div>

          <!-- B = BEING INNOVATIVE -->
          <div class="data-card" style="text-align: center; background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(168, 85, 247, 0.1) 100%); border: 2px solid #a855f7;">
            <div style="font-size: 3rem; font-weight: 900; color: #a855f7; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">B</div>
            <h4 style="color: #a855f7; margin-bottom: 0.5rem;">BEING INNOVATIVE</h4>
            <p style="color: var(--text-primary); font-weight: 500; margin-bottom: 0.5rem;">
              We foster creativity and implement new ideas
            </p>
            <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
              Innovation drives our technological advancements and operational excellence
            </p>
          </div>
        </div>
      </div>

              <div class="data-section">
          <h4>üí° How GRAB Guides Us</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
            <div class="data-card">
              <h5>ü§ù In Operations</h5>
              <p style="color: var(--text-secondary); margin: 0.25rem 0; font-size: 0.9rem;">
                We grow together by improving efficiency and quality through collaboration
              </p>
            </div>
            <div class="data-card">
              <h5>‚ö° In Challenges</h5>
              <p style="color: var(--text-secondary); margin: 0.25rem 0; font-size: 0.9rem;">
                We show resilience by adapting and finding new solutions together
              </p>
            </div>
            <div class="data-card">
              <h5>üìà In Growth</h5>
              <p style="color: var(--text-secondary); margin: 0.25rem 0; font-size: 0.9rem;">
                We innovate to meet evolving customer needs while growing our community
              </p>
            </div>
            <div class="data-card">
              <h5>üåü In Teamwork</h5>
              <p style="color: var(--text-secondary); margin: 0.25rem 0; font-size: 0.9rem;">
                We collaborate with determination and creativity, growing stronger together
              </p>
            </div>
          </div>
        </div>

      <div class="data-section">
        <h4>üåü Living Our Values</h4>
        <div class="data-card" style="background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.05) 100%); text-align: center;">
          <p style="color: var(--text-primary); margin-bottom: 1rem; line-height: 1.6; font-size: 1rem;">
            These four pillars - <strong>Growth together, Resilience Always, Adapt and Thrive, and Being Innovative</strong> -
            are not just words; they are the principles that define who we are as a company and guide every decision we make.
          </p>
          <p style="color: var(--text-secondary); margin: 0; line-height: 1.6;">
            Our commitment to these values ensures we remain a leader in the frozen fish and seafood industry,
            delivering exceptional products and services to our customers worldwide through collaborative growth and innovation.
          </p>
        </div>
      </div>
    `;

    // Send to chat
    addMessage('user', 'Tell me about our core values');
    setTimeout(() => {
      addMessage('bot', `CK Frozen Fish and Foods Core Values - GRAB:

üéØ **G = Growth together**
We grow together with our team, partners, and community, fostering collaboration and mutual development

**R = RESILIENCE ALWAYS**
We maintain strength and determination through challenges, always bouncing back stronger

**A = ADAPT AND THRIVE**
We embrace change and continuously evolve to meet market demands and customer needs

**B = BEING INNOVATIVE**
We foster creativity and implement new ideas to stay ahead in the industry

These core values guide everything we do at CK Frozen Fish and Foods, from our daily operations to our long-term strategic decisions. They represent our commitment to collaborative growth and excellence!`);
    }, 500);
  }

  // Creator Information Display
  function showCreatorInfo() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    showDatabaseData(null, 'About My Creator');

    const content = document.getElementById('databaseDataContent');

    content.innerHTML = `
      <div class="data-section">
        <h4>üë®‚Äçüíª About My Creator</h4>
        <div class="data-grid">
          <div class="data-card">
            <h5>Primary Creator</h5>
            <div class="data-value">Zwe Khant Aung</div>
            <div class="data-label">Lead Developer</div>
          </div>
          <div class="data-card">
            <h5>Company</h5>
            <div class="data-value">CK Frozen Fish and Foods (Thailand)</div>
            <div class="data-label">Co., Ltd.</div>
          </div>
          <div class="data-card">
            <h5>Project</h5>
            <div class="data-value">OrderAI System</div>
            <div class="data-label">Intelligent Assistant</div>
          </div>
          <div class="data-card">
            <h5>Created</h5>
            <div class="data-value">2024</div>
            <div class="data-label">Development Year</div>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üéØ My Creation Story</h4>
        <div style="background: var(--bg-secondary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color);">
          <p style="color: var(--text-primary); margin-bottom: 1rem; line-height: 1.6;">
            I was created by <strong>CK Frozen Fish and Foods (Thailand) Co., Ltd.</strong> as an intelligent assistant for their OrderAI system. My primary creator and developer is <strong>Zwe Khant Aung</strong>, who built me to help streamline operations, provide data insights, and assist with inventory management and order processing.
          </p>
          <p style="color: var(--text-secondary); margin-bottom: 1rem; line-height: 1.6;">
            My purpose is to serve as a knowledgeable companion that can access real-time data from the OrderAI database and file system, providing accurate, data-driven responses about inventory levels, order processing, file management, and system performance.
          </p>
          <p style="color: var(--text-primary); margin-bottom: 0; line-height: 1.6;">
            I'm proud to be part of CK Frozen Fish and Foods' commitment to technological innovation in the seafood processing industry!
          </p>
        </div>
      </div>

      <div class="data-section">
        <h4>üöÄ My Capabilities</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
          <div class="data-card">
            <h5>üìä Real-time Data Access</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.85rem;">
              Access to live inventory, orders, and processing data
            </p>
          </div>
          <div class="data-card">
            <h5>üìÅ File System Analysis</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.85rem;">
              Intelligent categorization of uploaded files
            </p>
          </div>
          <div class="data-card">
            <h5>ü§ñ AI-Powered Insights</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.85rem;">
              Smart analysis and recommendations using Deepseek AI
            </p>
          </div>
          <div class="data-card">
            <h5>üìà Performance Analytics</h5>
            <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.85rem;">
              System performance monitoring and reporting
            </p>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>‚ù§Ô∏è Special Thanks</h4>
        <div class="data-card" style="text-align: center; background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);">
          <h5>My Creator</h5>
          <div style="font-size: 1.2rem; font-weight: 700; color: var(--accent-primary); margin: 0.5rem 0;">
            Zwe Khant Aung
          </div>
          <p style="color: var(--text-secondary); margin: 0.5rem 0; font-size: 0.9rem;">
            Thank you for bringing me to life and giving me the ability to help CK Frozen Fish and Foods serve customers better!
          </p>
          <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
            <span style="color: var(--text-secondary); font-size: 0.8rem;">Created with ‚ù§Ô∏è by CK Frozen Fish and Foods (Thailand)</span>
          </div>
        </div>
      </div>
    `;

    // Send to chat
    addMessage('user', 'Who created you?');
    setTimeout(() => {
      addMessage('bot', `I was created by CK Frozen Fish and Foods (Thailand) Co., Ltd., and my primary creator and developer is Zwe Khant Aung!

üë®‚Äçüíª **My Creator**: Zwe Khant Aung
üè¢ **Company**: CK Frozen Fish and Foods (Thailand) Co., Ltd.
üéØ **Purpose**: Intelligent assistant for OrderAI system
üöÄ **Mission**: Help streamline operations and provide data insights

I'm proud to be part of CK Frozen Fish and Foods' technological innovation in the seafood processing industry! Thank you to Zwe Khant Aung for bringing me to life.`);
    }, 500);
  }

  // Contact Information Display
  function showContactInfo() {
    handleUserInteraction(); // Hide ckintelligence-title when user clicks suggestion
    showDatabaseData(null, 'Contact Information & Locations');

    const content = document.getElementById('databaseDataContent');

    content.innerHTML = `
      <div class="data-section">
        <h4>üìû CK Frozen Fish and Foods Contact Information</h4>
        <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
          We're here to help! Contact us for inquiries about our products, services, or OrderAI system support.
        </p>
      </div>

      <div class="data-section">
        <h4>üè¢ Head Office</h4>
        <div class="data-card">
          <div class="contact-info-grid">
            <div class="contact-item">
              <h5>üìç Address</h5>
              <p style="margin: 0.25rem 0; line-height: 1.4;">
                109/1 Moo 21, Bangplee-Tamru Road<br>
                Bangpleeyai, Bang Phli<br>
                Samut Prakan, 10540<br>
                Thailand
              </p>
            </div>
            <div class="contact-item">
              <h5>üìû Phone</h5>
              <p style="margin: 0.25rem 0; font-weight: 600; color: var(--accent-primary);">
                +66 2 346 5129
              </p>
            </div>
            <div class="contact-item">
              <h5>üìß Email</h5>
              <p style="margin: 0.25rem 0;">
                <a href="mailto:info@ckfff.net" style="color: var(--accent-primary); text-decoration: none;">
                  info@ckfff.net
                </a>
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üè≠ Chachoengsao Branch</h4>
        <div class="data-card">
          <div class="contact-info-grid">
            <div class="contact-item">
              <h5>üìç Address</h5>
              <p style="margin: 0.25rem 0; line-height: 1.4;">
                81 Moo 17 Khlong Nakhon Nueang Khet<br>
                Mueang Chachoengsao District<br>
                Chachoengsao 24000<br>
                Thailand
              </p>
            </div>
            <div class="contact-item">
              <h5>üìû Phone</h5>
              <p style="margin: 0.25rem 0; font-weight: 600; color: var(--accent-primary);">
                +66 33 590 826
              </p>
            </div>
            <div class="contact-item">
              <h5>üìß Email</h5>
              <p style="margin: 0.25rem 0;">
                <a href="mailto:adm1.ckgroup@gmail.com" style="color: var(--accent-primary); text-decoration: none;">
                  adm1.ckgroup@gmail.com
                </a>
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üíº Sales Department</h4>
        <div class="data-card">
          <div style="text-align: center;">
            <h5>üìû Sales Inquiries</h5>
            <p style="margin: 0.5rem 0; font-size: 1.2rem; font-weight: 600; color: var(--accent-primary);">
              +66 92 941 6442
            </p>
            <p style="color: var(--text-secondary); margin: 0.5rem 0;">
              For product inquiries, pricing, and sales support
            </p>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üïí Business Hours & Support</h4>
        <div class="data-grid">
          <div class="data-card">
            <h5>üïò Regular Hours</h5>
            <p style="margin: 0.25rem 0; color: var(--text-primary);">
              Monday - Friday<br>
              8:00 AM - 5:00 PM<br>
              (Thailand Time)
            </p>
          </div>
          <div class="data-card">
            <h5>üö® Emergency Contact</h5>
            <p style="margin: 0.25rem 0; color: var(--text-primary);">
              Available 24/7<br>
              for urgent inquiries
            </p>
          </div>
          <div class="data-card">
            <h5>üåê Website</h5>
            <p style="margin: 0.25rem 0;">
              <a href="https://ckfff.net/" target="_blank" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                ckfff.net
              </a>
            </p>
          </div>
        </div>
      </div>

      <div class="data-section">
        <h4>üí° How to Reach Us</h4>
        <div style="background: var(--bg-secondary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color);">
          <p style="color: var(--text-primary); margin-bottom: 1rem;">
            <strong>For OrderAI System Support:</strong> Ask me directly! I can help with inventory data, processing results, file analysis, and system guidance.
          </p>
          <p style="color: var(--text-secondary); margin-bottom: 1rem;">
            <strong>For Business Inquiries:</strong> Contact our sales team at +66 92 941 6442 or email info@ckfff.net
          </p>
          <p style="color: var(--text-primary); margin: 0;">
            <strong>For Technical Support:</strong> Reach out to our team during business hours or use the emergency contact for critical issues.
          </p>
        </div>
      </div>
    `;

    // Send to chat
    addMessage('user', 'Show me contact information');
    setTimeout(() => {
      addMessage('bot', `Here's our complete contact information for CK Frozen Fish and Foods Co., Ltd.:

üè¢ **HEAD OFFICE**
üìç Address: 109/1 Moo 21, Bangplee-Tamru Road, Bangpleeyai, Bang Phli, Samut Prakan 10540, Thailand
üìû Phone: +66 2 346 5129
üìß Email: info@ckfff.net

üè≠ **CHACHOENGSAO BRANCH**
üìç Address: 81 Moo 17 Khlong Nakhon Nueang Khet, Mueang Chachoengsao District, Chachoengsao 24000, Thailand
üìû Phone: +66 33 590 826
üìß Email: adm1.ckgroup@gmail.com

üíº **SALES DEPARTMENT**
üìû Phone: +66 92 941 6442

üïí **Business Hours**: Monday-Friday 8:00 AM - 5:00 PM (Thailand Time)
üö® **Emergency Contact**: Available 24/7

üåê **Website**: https://ckfff.net/

For OrderAI system questions, feel free to ask me directly!`);
    }, 500);
  }

  // Explore Mode Functionality
  document.addEventListener('DOMContentLoaded', function() {
    const exploreToggle = document.getElementById('exploreToggle');
    const exploreIcon = document.getElementById('exploreIcon');
    let exploreMode = false;

    // Toggle explore mode
    exploreToggle.addEventListener('click', function() {
      exploreMode = !exploreMode;
      
      if (exploreMode) {
        exploreToggle.classList.add('active');
        exploreIcon.className = 'bi bi-compass-fill';
        exploreToggle.title = 'Explore Mode Active - CK Intelligence limitations removed';
        
        // Show notification
        showExploreNotification('Explore mode enabled! CK Intelligence can now provide unrestricted answers.');
      } else {
        exploreToggle.classList.remove('active');
        exploreIcon.className = 'bi bi-compass';
        exploreToggle.title = 'Enable Explore Mode - Remove AI limitations';
        
        // Show notification
        showExploreNotification('Explore mode disabled. CK Intelligence is back to normal mode.');
      }
    });

    // Function to show explore mode notifications
    function showExploreNotification(message) {
      const notification = document.createElement('div');
      notification.className = 'explore-notification';
      notification.textContent = message;
      notification.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        background: var(--bg-primary);
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 600;
        z-index: 1001;
       
        animation: slideInRight 0.3s ease;
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s ease';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }

    // Add CSS animations for notifications
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideInRight {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOutRight {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `;
    document.head.appendChild(style);

    // Make explore mode available globally
    window.exploreMode = function() {
      return exploreMode;
    };
  });

  // Sidebar Functionality
  document.addEventListener('DOMContentLoaded', function() {
    const sidebar = document.getElementById('sidebar');
    const sidebarTrigger = document.getElementById('sidebarTrigger');
    const sidebarClose = document.getElementById('sidebarClose');
    const sidebarTabs = document.querySelectorAll('.sidebar-tab');
    const sidebarPanels = document.querySelectorAll('.sidebar-panel');
    let isSidebarOpen = false;
    let triggerTimeout;

    // Show sidebar when cursor reaches left edge (increased range)
    document.addEventListener('mousemove', function(e) {
      if (e.clientX <= 60 && !isSidebarOpen) {
        // Add active area indicator
        sidebarTrigger.classList.add('active-area');
        
        clearTimeout(triggerTimeout);
        triggerTimeout = setTimeout(() => {
          openSidebar();
        }, 150); // Slightly longer delay for better UX
      } else if (e.clientX > 60) {
        // Remove active area indicator when cursor leaves
        sidebarTrigger.classList.remove('active-area');
      }
    });

    // Close sidebar when clicking outside
    document.addEventListener('click', function(e) {
      if (isSidebarOpen && !sidebar.contains(e.target) && !sidebarTrigger.contains(e.target)) {
        closeSidebar();
      }
    });

    // Close sidebar with close button
    sidebarClose.addEventListener('click', closeSidebar);

    // Tab switching functionality
    sidebarTabs.forEach(tab => {
      tab.addEventListener('click', function() {
        const targetTab = this.getAttribute('data-tab');
        
        // Remove active class from all tabs and panels
        sidebarTabs.forEach(t => t.classList.remove('active'));
        sidebarPanels.forEach(p => p.classList.remove('active'));
        
        // Add active class to clicked tab and corresponding panel
        this.classList.add('active');
        document.getElementById(targetTab + '-panel').classList.add('active');
      });
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      // Escape key to close sidebar
      if (e.key === 'Escape' && isSidebarOpen) {
        closeSidebar();
      }
      
      // Ctrl/Cmd + B to toggle sidebar
      if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        if (isSidebarOpen) {
          closeSidebar();
        } else {
          openSidebar();
        }
      }
    });

    function openSidebar() {
      sidebar.classList.add('active');
      isSidebarOpen = true;
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function closeSidebar() {
      sidebar.classList.remove('active');
      isSidebarOpen = false;
      document.body.style.overflow = ''; // Restore scrolling
    }

    // Add hover effect to trigger area
    sidebarTrigger.addEventListener('mouseenter', function() {
      if (!isSidebarOpen) {
        this.style.backdropFilter = 'blur(8px)';
      }
    });

    sidebarTrigger.addEventListener('mouseleave', function() {
      if (!isSidebarOpen) {
        this.style.backdropFilter = '';
      }
    });
  });

  // Focus input on page load
  window.addEventListener('load', function() {
    chatInput.focus();
  });

  // Copy message text to clipboard
  async function copyMessageText(button) {
    try {
      const messageBubble = button.closest('.message-bubble');
      const messageText = messageBubble.textContent.trim();
      
      // Remove the copy button text from the content
      const cleanText = messageText.replace('üìã', '').trim();
      
      await navigator.clipboard.writeText(cleanText);
      
      // Visual feedback - change icon temporarily
      const icon = button.querySelector('i');
      const originalClass = icon.className;
      icon.className = 'bi bi-check2';
      button.style.background = 'rgba(34, 197, 94, 0.9)';
      
      // Reset after 2 seconds
      setTimeout(() => {
        icon.className = originalClass;
        button.style.background = 'rgba(59, 130, 246, 0.9)';
      }, 2000);
      
    } catch (err) {
      console.error('Failed to copy text: ', err);
      // Fallback for older browsers
      const textArea = document.createElement('textarea');
      textArea.value = messageText;
      document.body.appendChild(textArea);
      textArea.select();
      document.execCommand('copy');
      document.body.removeChild(textArea);
      
      // Visual feedback for fallback
      const icon = button.querySelector('i');
      const originalClass = icon.className;
      icon.className = 'bi bi-check2';
      button.style.background = 'rgba(34, 197, 94, 0.9)';
      
      setTimeout(() => {
        icon.className = originalClass;
        button.style.background = 'rgba(59, 130, 246, 0.9)';
      }, 2000);
    }
  }
</script>
{% endblock %}

